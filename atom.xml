<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Coly</title>
  <subtitle>宁静致远</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-04-09T14:43:01.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Coly Fu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>GWAS如何确定候选区间和causal gene</title>
    <link href="http://yoursite.com/2017/04/09/GWAS%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E5%80%99%E9%80%89%E5%8C%BA%E9%97%B4%E5%92%8Ccausal-gene/"/>
    <id>http://yoursite.com/2017/04/09/GWAS如何确定候选区间和causal-gene/</id>
    <published>2017-04-09T12:33:37.000Z</published>
    <updated>2017-04-09T14:43:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>随着高通量测序成本的急剧下降，越来越多的GWAS研究通过全基因组重测序获得标记。全基因组重测序的高密度标记，使得通过GWAS研究快速找到causal gene甚至causal mutation成为可能。但是通过GWAS得到一个信号后，怎么确定与这个信号关联的基因呢？<br>基本的思路就是找与这个信号强连锁的区域，一般来说r<sup>2</sup>大于0.6的区域视为强连锁的区域。简单粗糙的做法：我们可以通过群体的全基因组LD-decay分析，找到LD decay到r<sup>2</sup>等于0.6时所对应的距离，将GWAS超过阈值的信号前后各延伸这个距离作为候选区间。<br>但是基因组不同区域的连锁程度差异很大，上面一刀切的做法可能使我们漏掉一些基因，或者多调查许多关联性并不强的基因。而且很多作物的连锁性很强，导致候选基因很多，这样就大大增加了工作难度。下面介绍一个非常简单高效的方法（<a href="http://www.nature.com/ng/journal/v48/n8/abs/ng.3596.html" target="_blank" rel="external">参考文献</a>）。<br><img src="http://onzjn6hm6.bkt.clouddn.com/20170409_heatmap.png" alt="heatmap">  </p>
<ol>
<li><p>找到信号后，向前后延伸一段距离（可以根据全基因组的LD-decay水平大概估计），计算这段区域内所有标记pairwise r<sup>2</sup>，将r<sup>2</sup>大于0.6的block作为候选区间。pairwise r<sup>2</sup>可以用<a href="http://zzz.bwh.harvard.edu/plink/" target="_blank" rel="external">PLINK</a>计算：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> plink --noweb --bfile &lt;bfile_prefix&gt; \  </div><div class="line">       --chr 5 --from-bp 13641890 --to-bp 17641890 \  </div><div class="line">       --matrix --r2 --out &lt;out_prefix&gt;</div><div class="line"> ```  </div><div class="line"> 画图用R,输入文件为plink计算的到的r&lt;sup&gt;2&lt;/sup&gt;矩阵，以及标记的位置:</div><div class="line"> </div><div class="line">  ```R</div><div class="line"><span class="comment">#!/usr/bin/env Rscript</span></div><div class="line">library(LDheatmap)</div><div class="line">argv &lt;- <span class="built_in">command</span>Args(TRUE)</div><div class="line">ldmatrix &lt;- as.matrix(read.table(argv[1],sep=<span class="string">' '</span>))</div><div class="line">pos &lt;- as.numeric(unlist(read.table(argv[2], head=FALSE)))</div><div class="line">pdf(argv[3])</div><div class="line">rgb.palette &lt;- colorRampPalette(rev(c(<span class="string">"yellow"</span>, <span class="string">"orange"</span>, <span class="string">"red"</span>)), space = <span class="string">"rgb"</span>)</div><div class="line">LDheatmap(ldmatrix, genetic.distances=pos, color=rgb.palette(100), flip=TRUE)</div><div class="line">dev.off()</div></pre></td></tr></table></figure>
</li>
<li><p>将这个区域内的标记按照其对基因功能的影响程度分为5类：  </p>
<blockquote>
<p>1） 标记与性状显著关联（-log<sub>10</sub>P大于阈值），且该标记影响氨基酸编码，或者位于剪接位点；<br>2） 标记与性状显著关联，且位于基因起始密码子上游2 kb内；<br>3） 标记与性状显著关联，且位于基因内，除开1）和2）之外的标记<br>4） 标记与性状显著关联，位于基因间区<br>5） 标记与性状不显著关联  </p>
</blockquote>
</li>
</ol>
<p>然后，按照这5类的顺序，依次调查，一般来说，属于1）类的可能性很大，而且基因一般就几个，这样就大大减少了工作难度。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;随着高通量测序成本的急剧下降，越来越多的GWAS研究通过全基因组重测序获得标记。全基因组重测序的高密度标记，使得通过GWAS研究快速找到causal gene甚至causal mutation成为可能。但是通过GWAS得到一个信号后，怎么确定与这个信号关联的基因呢？&lt;br&gt;
    
    </summary>
    
      <category term="GWAS" scheme="http://yoursite.com/categories/GWAS/"/>
    
    
      <category term="GWAS" scheme="http://yoursite.com/tags/GWAS/"/>
    
      <category term="causal gene" scheme="http://yoursite.com/tags/causal-gene/"/>
    
      <category term="LD" scheme="http://yoursite.com/tags/LD/"/>
    
      <category term="heat map" scheme="http://yoursite.com/tags/heat-map/"/>
    
  </entry>
  
</feed>
