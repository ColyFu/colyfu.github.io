<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Things worth spreading!</title>
  <subtitle>Knowledge is a good thing, and good things are worth spreading!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.colyfu.com/"/>
  <updated>2017-06-28T09:55:17.000Z</updated>
  <id>http://www.colyfu.com/</id>
  
  <author>
    <name>Coly Fu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>LiftOver chain 文件创建流程</title>
    <link href="http://www.colyfu.com/genomics/liftover-chain.html"/>
    <id>http://www.colyfu.com/genomics/liftover-chain.html</id>
    <published>2017-06-28T09:49:20.000Z</published>
    <updated>2017-06-28T09:55:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>当我们所研究的物种有多个基因组组装版本的时候，我们往往需要将两个版本的位置对应起来。比如某个版本注释了某些转录因子，而另外一个版本没有注释，我们需要知道这些转录因子在另一个版本的位置。比如早期的QTL研究是基于老版本的参考序列，我们需要知道这些QTL在新版本参考序列中的位置等等。</p>
<p>最常用的工具是UCSC的<a href="https://genome.ucsc.edu/cgi-bin/hgLiftOver" target="_blank" rel="external">LiftOver</a>，如果你所研究的物种刚好是LiftOver支持的物种，那很幸运，可以直接使用其在线工具，或者下载<a href="http://hgdownload.cse.ucsc.edu/downloads.html#liftover" target="_blank" rel="external">chain</a>文件后，通过<a href="https://pypi.python.org/pypi/pyliftover" target="_blank" rel="external">pyliftover</a>或<a href="http://crossmap.sourceforge.net/index.html" target="_blank" rel="external">CrossMap</a>等工具转换。如果没有做好的chain文件，那需要自己生成。UCSC对于自行生成chain文件有详细的<a href="http://genomewiki.ucsc.edu/index.php/Same_species_lift_over_construction" target="_blank" rel="external">pipeline</a>，所以这篇博客不对每一步作详细说明，只提供主要步骤说明，并避开UCSC流程中的一些坑。</p>
<a id="more"></a>
<ul>
<li>BLAT比对</li>
</ul>
<p>既然要对应两个序列，那最直接的方式就是比对了，liftover原理主要基于此，并把位置关系存在chain文件中，用于后续查询。参考序列相近，比如同个物种的两个不同组装版本，可以用blat比对，如果是不同物种，则需要用<a href="http://genomewiki.ucsc.edu/index.php/Whole_genome_alignment_howto" target="_blank" rel="external">blastz</a>进行比对。</p>
<p>我对UCSC的pipeline进行了一些修改，命名为<a href="https://pan.baidu.com/s/1i57Rnhj" target="_blank" rel="external">chain_step*.sh</a>，中间需要修改或注意的地方加了注释。在运行之前，需要 1) 下载并编译好UCSC的<a href="https://github.com/ENCODE-DCC/kentUtils" target="_blank" rel="external">kentUtils</a>，liftover主要用到其中一系列工具。2) 将需要对应的两个参考序列转为2bit格式，并放在同一个目录下，可以用kentUtils的<code>twoBitToFa</code>进行转换。3）修改<code>chain_step1.sh</code>中的必要参数。主要需要修改的是kentUtils路径，工作路径，两个2bit格式参考序列前缀。需要指出的是，targetDb为已知位置的序列，queryDb为查询序列，即将targetDb的位置转为queryDb的位置。</p>
<p>运行该步后，会在run.blat目录下生成一个jobList，如果任务少，可以直接<code>sh jobList</code>运行，如果任务多，可以在集群上用SGE投递任务。运行需要<code>blatJob.csh</code>脚本，注意修改blatJob.csh中blat和kentUtils路径。</p>
<p><strong>最大的坑出现了!!!</strong></p>
<p>jobList里面的任务运行完之后，并不能直接运行流程接下来的部分，这是UCSC流程最大的坑。在<code>run.blat/psl/*/</code>目录下，生成了一系列的psl格式的比对结果，需要对该结果进行修改，主要是因为对targetDb序列进行了切割，psl文件里面记录的染色体名和长度以及比对的位置都需要进行调整。该调整可以通过脚本<code>change_psl.py</code>实现，如需要对所有psl文件进行调整，则在psl目录下运行<code>ls */*.psl|while read a;do python change_psl.py $a target.fa.fai ;done</code>，其中target.fa.fai是待转换参考序列fa格式的fai文件，通过<code>samtools faidx target.fa</code>生成。</p>
<ul>
<li>生成chain文件</li>
</ul>
<p>第一步完成后，接下来就比较简单了。在工作目录下运行<code>chain_step2.sh</code>后，会在<code>run.chain</code>目录下生成<code>jobList</code>，直接运行或拆分后用SGE投递。<br>jobList任务运行结束后，在工作目录运行<code>chain_step3.sh</code>，会在<code>run.chain</code>目录下生成<code>doNet.csh</code>，直接运行该脚本。注意修改step2和step3脚本中的路径。</p>
<p>运行结束后，会在工作目录生成后缀为<code>.over.chain.gz</code>的压缩文件，该文件就是我们需要的chain文件。</p>
<p>至此，大功告成！</p>
<p>利用该文件，就可以使用CrossMap对bed/gtf/gff/bam/vcf等文件中的参考序列位置进行转换。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;当我们所研究的物种有多个基因组组装版本的时候，我们往往需要将两个版本的位置对应起来。比如某个版本注释了某些转录因子，而另外一个版本没有注释，我们需要知道这些转录因子在另一个版本的位置。比如早期的QTL研究是基于老版本的参考序列，我们需要知道这些QTL在新版本参考序列中的位置等等。&lt;/p&gt;
&lt;p&gt;最常用的工具是UCSC的&lt;a href=&quot;https://genome.ucsc.edu/cgi-bin/hgLiftOver&quot;&gt;LiftOver&lt;/a&gt;，如果你所研究的物种刚好是LiftOver支持的物种，那很幸运，可以直接使用其在线工具，或者下载&lt;a href=&quot;http://hgdownload.cse.ucsc.edu/downloads.html#liftover&quot;&gt;chain&lt;/a&gt;文件后，通过&lt;a href=&quot;https://pypi.python.org/pypi/pyliftover&quot;&gt;pyliftover&lt;/a&gt;或&lt;a href=&quot;http://crossmap.sourceforge.net/index.html&quot;&gt;CrossMap&lt;/a&gt;等工具转换。如果没有做好的chain文件，那需要自己生成。UCSC对于自行生成chain文件有详细的&lt;a href=&quot;http://genomewiki.ucsc.edu/index.php/Same_species_lift_over_construction&quot;&gt;pipeline&lt;/a&gt;，所以这篇博客不对每一步作详细说明，只提供主要步骤说明，并避开UCSC流程中的一些坑。&lt;/p&gt;
    
    </summary>
    
      <category term="genomics" scheme="http://www.colyfu.com/categories/genomics/"/>
    
    
      <category term="LiftOver" scheme="http://www.colyfu.com/tags/LiftOver/"/>
    
      <category term="chain" scheme="http://www.colyfu.com/tags/chain/"/>
    
      <category term="CrossMap" scheme="http://www.colyfu.com/tags/CrossMap/"/>
    
      <category term="pyliftover" scheme="http://www.colyfu.com/tags/pyliftover/"/>
    
      <category term="UCSC" scheme="http://www.colyfu.com/tags/UCSC/"/>
    
      <category term="基因组序列位置对应" scheme="http://www.colyfu.com/tags/%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%BA%8F%E5%88%97%E4%BD%8D%E7%BD%AE%E5%AF%B9%E5%BA%94/"/>
    
  </entry>
  
  <entry>
    <title>文献速递 (2017年5月)</title>
    <link href="http://www.colyfu.com/paper-express/paper-express-201705.html"/>
    <id>http://www.colyfu.com/paper-express/paper-express-201705.html</id>
    <published>2017-06-03T10:36:01.000Z</published>
    <updated>2017-06-03T10:38:53.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Two-extended-haplotype-blocks-are-associated-with-adaptation-to-high-altitude-habitats-in-East-African-honey-bees-gt-gt-gt"><a href="#Two-extended-haplotype-blocks-are-associated-with-adaptation-to-high-altitude-habitats-in-East-African-honey-bees-gt-gt-gt" class="headerlink" title="Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees &gt;&gt;&gt;"></a>Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees <a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006792" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>PLoS Genet 13(5): e1006792.<br>作者通过对东非意蜂高海拔和低海拔群体进行全基因组测序，发现高海拔和低海拔群体基因组之间存在两个遗传差异非常大的区段。其中一个区段存在一系列章鱼胺受体，推测与高海拔和低海拔群体的学习和觅食行为差异有关。这两个区段极大的遗传差异暗示了这些群体古老的起源，祖先群体很可能在传播到当前区域之前就存在不同的环境适应性了。</p>
<h4 id="Pollutants-and-Insecticides-Drive-Local-Adaptation-in-African-Malaria-Mosquitoes-gt-gt-gt"><a href="#Pollutants-and-Insecticides-Drive-Local-Adaptation-in-African-Malaria-Mosquitoes-gt-gt-gt" class="headerlink" title="Pollutants and Insecticides Drive Local Adaptation in African Malaria Mosquitoes &gt;&gt;&gt;"></a>Pollutants and Insecticides Drive Local Adaptation in African Malaria Mosquitoes <a href="https://academic.oup.com/mbe/article/34/5/1261/2996747/Pollutants-and-Insecticides-Drive-Local-Adaptation" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Mol Biol Evol (2017) 34 (5): 1261-1275.<br>对喀麦隆地区941只疟蚊进行简化基因组测序，得到8000个SNP标记。分析发现这些蚊子存在城市和乡村的群体遗传分化，城市污染地区的蚊子存在对杀虫剂的适应性。  </p>
<a id="more"></a>
<h4 id="Mitogenome-Diversity-in-Sardinians-A-Genetic-Window-onto-an-Island’s-Past-gt-gt-gt"><a href="#Mitogenome-Diversity-in-Sardinians-A-Genetic-Window-onto-an-Island’s-Past-gt-gt-gt" class="headerlink" title="Mitogenome Diversity in Sardinians: A Genetic Window onto an Island’s Past &gt;&gt;&gt;"></a>Mitogenome Diversity in Sardinians: A Genetic Window onto an Island’s Past <a href="https://academic.oup.com/mbe/article/34/5/1230/2977388/Mitogenome-Diversity-in-Sardinians-A-Genetic" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Mol Biol Evol (2017) 34 (5): 1230-1239.<br>撒丁岛人被认为是欧洲遗传组成的‘离群值’。作者对3,491个现代和21个古代撒丁岛人的线粒体基因组进行了研究，发现78.4%的现代线粒体基因组都能被分到89个单体型。作者发现大部分的线粒体基因组的溯祖时间大概在青铜时代，但也有一些稀有线粒体基因组的溯祖时间在新石器时代。  </p>
<h4 id="Evolution-of-Local-Mutation-Rate-and-Its-Determinants-gt-gt-gt"><a href="#Evolution-of-Local-Mutation-Rate-and-Its-Determinants-gt-gt-gt" class="headerlink" title="Evolution of Local Mutation Rate and Its Determinants &gt;&gt;&gt;"></a>Evolution of Local Mutation Rate and Its Determinants <a href="https://academic.oup.com/mbe/article/34/5/1100/2963012/Evolution-of-Local-Mutation-Rate-and-Its" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Mol Biol Evol (2017) 34 (5): 1100-1109.<br>人基因组不同的区域，突变率存在差异，部分可以通过DNA分子不同区域的性质来解释。但是不同物种的同源区域突变率的差异的形成原因还不清楚，本文给出了一些解释。</p>
<h4 id="The-Demographic-and-Adaptive-History-of-the-African-Green-Monkey-gt-gt-gt"><a href="#The-Demographic-and-Adaptive-History-of-the-African-Green-Monkey-gt-gt-gt" class="headerlink" title="The Demographic and Adaptive History of the African Green Monkey &gt;&gt;&gt;"></a>The Demographic and Adaptive History of the African Green Monkey <a href="https://academic.oup.com/mbe/article-abstract/34/5/1055/2983514/The-Demographic-and-Adaptive-History-of-the?redirectedFrom=fulltext" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Mol Biol Evol (2017) 34 (5): 1055-1065.</p>
<p>通过来自非洲绿猴所有5个群体的25个个体进行研究，揭示了绿猴的群体历史和适应性。</p>
<h4 id="GppFst-genomic-posterior-predictive-simulations-of-FST-and-dXY-for-identifying-outlier-loci-from-population-genomic-data-gt-gt-gt"><a href="#GppFst-genomic-posterior-predictive-simulations-of-FST-and-dXY-for-identifying-outlier-loci-from-population-genomic-data-gt-gt-gt" class="headerlink" title="GppFst: genomic posterior predictive simulations of FST and dXY for identifying outlier loci from population genomic data &gt;&gt;&gt;"></a>GppFst: genomic posterior predictive simulations of FST and dXY for identifying outlier loci from population genomic data <a href="https://academic.oup.com/bioinformatics/article-abstract/33/9/1414/2736363/GppFst-genomic-posterior-predictive-simulations-of?redirectedFrom=fulltext" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Bioinformatics (2017) 33 (9): 1414-1415.<br>通过后验预测模拟FST和dXY来发现基因组受选择区域。</p>
<h4 id="fastMitoCalc-an-ultra-fast-program-to-estimate-mitochondrial-DNA-copy-number-from-whole-genome-sequences-gt-gt-gt"><a href="#fastMitoCalc-an-ultra-fast-program-to-estimate-mitochondrial-DNA-copy-number-from-whole-genome-sequences-gt-gt-gt" class="headerlink" title="fastMitoCalc: an ultra-fast program to estimate mitochondrial DNA copy number from whole-genome sequences &gt;&gt;&gt;"></a>fastMitoCalc: an ultra-fast program to estimate mitochondrial DNA copy number from whole-genome sequences <a href="https://academic.oup.com/bioinformatics/article-abstract/33/9/1399/2832783/fastMitoCalc-an-ultra-fast-program-to-estimate?redirectedFrom=fulltext" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Bioinformatics (2017) 33 (9): 1399-1401.<br>快速估计细胞中平均线粒体拷贝数。其基本思想就是和常染色体测序深度比较。只是没有计算常染色体所有区域，只抽取了0.1%来计算，这样大大加快了计算速度。（这也能发Bioinformatics？？？）</p>
<h4 id="VCF-kit-assorted-utilities-for-the-variant-call-format-gt-gt-gt"><a href="#VCF-kit-assorted-utilities-for-the-variant-call-format-gt-gt-gt" class="headerlink" title="VCF-kit: assorted utilities for the variant call format &gt;&gt;&gt;"></a>VCF-kit: assorted utilities for the variant call format <a href="https://academic.oup.com/bioinformatics/article/33/10/1581/2908861/VCF-kit-assorted-utilities-for-the-variant-call" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Bioinformatics (2017) 33 (10): 1581-1582.<br>对VCF文件进行过滤等计算的工具。其中设计引物的功能可能是比较其他工具比较实用的。</p>
<h4 id="KNIME4NGS-a-comprehensive-toolbox-for-next-generation-sequencing-analysis-gt-gt-gt"><a href="#KNIME4NGS-a-comprehensive-toolbox-for-next-generation-sequencing-analysis-gt-gt-gt" class="headerlink" title="KNIME4NGS: a comprehensive toolbox for next generation sequencing analysis &gt;&gt;&gt;"></a>KNIME4NGS: a comprehensive toolbox for next generation sequencing analysis <a href="https://academic.oup.com/bioinformatics/article-abstract/33/10/1565/2871246/KNIME4NGS-a-comprehensive-toolbox-for-next?redirectedFrom=fulltext" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Bioinformatics (2017) 33 (10): 1565-1567.<br>NGS数据分析pipeline，包括RNA的差异表达，DNA的质控，比对，SNP calling，BQSR，BQSR，VEP等等工具。</p>
<h4 id="Widespread-Allelic-Heterogeneity-in-Complex-Traits-gt-gt-gt-30149-0"><a href="#Widespread-Allelic-Heterogeneity-in-Complex-Traits-gt-gt-gt-30149-0" class="headerlink" title="Widespread Allelic Heterogeneity in Complex Traits &gt;&gt;&gt;30149-0)"></a>Widespread Allelic Heterogeneity in Complex Traits <a href="http://www.cell.com/ajhg/abstract/S0002-9297(17" target="_blank" rel="external">&gt;&gt;&gt;</a>30149-0)</h4><p>AJHG (2017) 100(5): 789-802<br>等位基因异质性普遍存在于复杂性状中，这降低了统计的显著性。理解等位基因异质性，有助于我们开发新的方法进行遗传定位。  </p>
<h4 id="Inferring-Human-Demographic-Histories-of-Non-African-Populations-from-Patterns-of-Allele-Sharing-gt-gt-gt-30146-5"><a href="#Inferring-Human-Demographic-Histories-of-Non-African-Populations-from-Patterns-of-Allele-Sharing-gt-gt-gt-30146-5" class="headerlink" title="Inferring Human Demographic Histories of Non-African Populations from Patterns of Allele Sharing &gt;&gt;&gt;30146-5)"></a>Inferring Human Demographic Histories of Non-African Populations from Patterns of Allele Sharing <a href="http://www.cell.com/ajhg/abstract/S0002-9297(17" target="_blank" rel="external">&gt;&gt;&gt;</a>30146-5)</h4><p>AJHG (2017) 100(5): 766-772.<br>通过简单的基于简约法的分析揭示东亚人和美拉尼西亚人是姐妹群。</p>
<h4 id="Dispersals-and-genetic-adaptation-of-Bantu-speaking-populations-in-Africa-and-North-America-gt-gt-gt"><a href="#Dispersals-and-genetic-adaptation-of-Bantu-speaking-populations-in-Africa-and-North-America-gt-gt-gt" class="headerlink" title="Dispersals and genetic adaptation of Bantu-speaking populations in Africa and North America &gt;&gt;&gt;"></a>Dispersals and genetic adaptation of Bantu-speaking populations in Africa and North America <a href="http://science.sciencemag.org/content/356/6337/543" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Science  05 May 2017:<br>Vol. 356, Issue 6337, pp. 543-546<br>对来自35个群体的1318个班图语系人的遗传数据进行分析，发现在向非洲南部和东部扩散之前，班图语系人首先沿着赤道雨林向南迁徙。和当地人的混合，帮助了班图语系人适应当地环境。发现了非洲中西部班图语系人对非裔美国人的遗传贡献。  </p>
<h4 id="New-advances-in-sequence-assembly-gt-gt-gt"><a href="#New-advances-in-sequence-assembly-gt-gt-gt" class="headerlink" title="New advances in sequence assembly &gt;&gt;&gt;"></a>New advances in sequence assembly <a href="http://genome.cshlp.org/content/27/5/xi.full" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Genome Res. May 2017; 27 <a href="http://genome.cshlp.org/content/27/5.toc" target="_blank" rel="external">(5)</a><br>这篇文章是编辑对于本期涉及组装方法的综述。这一期的文章主要讲基因组组装方法的进展，特别是长读长reads的组装方法。</p>
<h4 id="Discovery-and-genotyping-of-structural-variation-from-long-read-haploid-genome-sequence-data-gt-gt-gt"><a href="#Discovery-and-genotyping-of-structural-variation-from-long-read-haploid-genome-sequence-data-gt-gt-gt" class="headerlink" title="Discovery and genotyping of structural variation from long-read haploid genome sequence data &gt;&gt;&gt;"></a>Discovery and genotyping of structural variation from long-read haploid genome sequence data <a href="http://genome.cshlp.org/content/27/5/677.abstract" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Genome Res. 2017. 27: 677-685<br>利用长读长reads检测结构变异。</p>
<h4 id="A-comparative-evaluation-of-genome-assembly-reconciliation-tools-gt-gt-gt"><a href="#A-comparative-evaluation-of-genome-assembly-reconciliation-tools-gt-gt-gt" class="headerlink" title="A comparative evaluation of genome assembly reconciliation tools &gt;&gt;&gt;"></a>A comparative evaluation of genome assembly reconciliation tools <a href="http://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1213-3" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Genome Biology 2017 18:93<br>在基因组组装时，往往会用多个软件和参数组装多个版本，一般会挑一个最好的结果发表，也有将多个版本合并在一起，得到一个一致组装序列。对于后者，工具很多，本文对这些工具进行了评估。</p>
<h4 id="African-genomes-illuminate-the-early-history-and-transition-to-selfing-in-Arabidopsis-thaliana-gt-gt-gt"><a href="#African-genomes-illuminate-the-early-history-and-transition-to-selfing-in-Arabidopsis-thaliana-gt-gt-gt" class="headerlink" title="African genomes illuminate the early history and transition to selfing in Arabidopsis thaliana &gt;&gt;&gt;"></a>African genomes illuminate the early history and transition to selfing in Arabidopsis thaliana <a href="http://www.pnas.org/content/114/20/5213.full" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>PNAS (2017) 114(20): 5213–5218</p>
<p>作者对78个非洲拟南芥进行测序，同1000多个已经测序的欧亚拟南芥一起分析。发现非洲拟南芥就是当地起源的，而且多态性最高，还发现拟南芥的自交性状是在非洲一个地方转变完成。文章对拟南芥的分歧时间，群体动态进行了推断。（研究植物群体历史的文章比较少，这篇看上去很有参考价值！）</p>
<h4 id="digit—a-tool-for-detection-and-identification-of-genomic-interchromosomal-translocations-gt-gt-gt"><a href="#digit—a-tool-for-detection-and-identification-of-genomic-interchromosomal-translocations-gt-gt-gt" class="headerlink" title="digit—a tool for detection and identification of genomic interchromosomal translocations &gt;&gt;&gt;"></a>digit—a tool for detection and identification of genomic interchromosomal translocations <a href="https://academic.oup.com/nar/article/45/9/e72/2962178/digit-a-tool-for-detection-and-identification-of" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nucleic Acids Res (2017) 45 (9): e72.<br>基于pair end和mate pair数据检测染色体间异位的工具。</p>
<h4 id="Signatures-of-adaptation-in-the-weedy-rice-genome-gt-gt-gt"><a href="#Signatures-of-adaptation-in-the-weedy-rice-genome-gt-gt-gt" class="headerlink" title="Signatures of adaptation in the weedy rice genome &gt;&gt;&gt;"></a>Signatures of adaptation in the weedy rice genome <a href="http://www.nature.com/ng/journal/v49/n5/full/ng.3825.html" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nature Genetics 49, 811–814 (2017)<br>作者通过全基因组测序研究了美国两种主要杂草稻的起源和适应性。杂草稻从栽培稻祖先去驯化在其进化历史上扮演关键作用。</p>
<h4 id="Transitioning-from-association-to-causation-with-eQTLs-gt-gt-gt"><a href="#Transitioning-from-association-to-causation-with-eQTLs-gt-gt-gt" class="headerlink" title="Transitioning from association to causation with eQTLs &gt;&gt;&gt;"></a>Transitioning from association to causation with eQTLs <a href="http://www.nature.com/nrg/journal/v18/n5/full/nrg.2017.22.html" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nature Reviews Genetics 18, 271 (2017)<br>从关联到因果的转变－通过eQTLs。该文章介绍了AJHG的两篇文章，说明了eQTLs在寻找causal gene的作用。</p>
<h4 id="Sequencing-and-de-novo-assembly-of-a-near-complete-indica-rice-genome-gt-gt-gt"><a href="#Sequencing-and-de-novo-assembly-of-a-near-complete-indica-rice-genome-gt-gt-gt" class="headerlink" title="Sequencing and de novo assembly of a near complete indica rice genome &gt;&gt;&gt;"></a>Sequencing and de novo assembly of a near complete indica rice genome <a href="http://www.nature.com/articles/ncomms15324" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nature Communications 8, 15324 (2017)<br>通过单分子测序，遗传图谱，fosmid等组装了籼稻Shuhui498的基因组，组装长度为390.3 Mb，覆盖Shuhui498基因组99%以上。</p>
<h4 id="An-integrated-model-for-detecting-significant-chromatin-interactions-from-high-resolution-Hi-C-data-gt-gt-gt"><a href="#An-integrated-model-for-detecting-significant-chromatin-interactions-from-high-resolution-Hi-C-data-gt-gt-gt" class="headerlink" title="An integrated model for detecting significant chromatin interactions from high-resolution Hi-C data &gt;&gt;&gt;"></a>An integrated model for detecting significant chromatin interactions from high-resolution Hi-C data <a href="http://www.nature.com/articles/ncomms15454" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nature Communications 8, 15454 (2017)<br>通过高分辨率的Hi-C数据检测显著染色体互作的整合模型。</p>
<h4 id="Genomic-variation-associated-with-local-adaptation-of-weedy-rice-during-de-domestication-gt-gt-gt"><a href="#Genomic-variation-associated-with-local-adaptation-of-weedy-rice-during-de-domestication-gt-gt-gt" class="headerlink" title="Genomic variation associated with local adaptation of weedy rice during de-domestication &gt;&gt;&gt;"></a>Genomic variation associated with local adaptation of weedy rice during de-domestication <a href="http://www.nature.com/articles/ncomms15323" target="_blank" rel="external">&gt;&gt;&gt;</a></h4><p>Nature Communications 8, 15323 (2017)<br>作者对155株杂草稻和76株当地栽培稻进行了平均18.2 x的全基因组测序。通过系统发育树和群体动态分析发现，中国的杂草稻是独立从栽培稻去驯化形成的，中间经理了强的瓶颈效应。虽然有多个起源，杂草稻的关键基因显示了趋同进化。在杂草稻中鉴定出Mb大小的区段显示经历过平衡选择，而栽培稻没有。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;Two-extended-haplotype-blocks-are-associated-with-adaptation-to-high-altitude-habitats-in-East-African-honey-bees-gt-gt-gt&quot;&gt;&lt;a href=&quot;#Two-extended-haplotype-blocks-are-associated-with-adaptation-to-high-altitude-habitats-in-East-African-honey-bees-gt-gt-gt&quot; class=&quot;headerlink&quot; title=&quot;Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees &amp;gt;&amp;gt;&amp;gt;&quot;&gt;&lt;/a&gt;Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees &lt;a href=&quot;http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006792&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;PLoS Genet 13(5): e1006792.&lt;br&gt;作者通过对东非意蜂高海拔和低海拔群体进行全基因组测序，发现高海拔和低海拔群体基因组之间存在两个遗传差异非常大的区段。其中一个区段存在一系列章鱼胺受体，推测与高海拔和低海拔群体的学习和觅食行为差异有关。这两个区段极大的遗传差异暗示了这些群体古老的起源，祖先群体很可能在传播到当前区域之前就存在不同的环境适应性了。&lt;/p&gt;
&lt;h4 id=&quot;Pollutants-and-Insecticides-Drive-Local-Adaptation-in-African-Malaria-Mosquitoes-gt-gt-gt&quot;&gt;&lt;a href=&quot;#Pollutants-and-Insecticides-Drive-Local-Adaptation-in-African-Malaria-Mosquitoes-gt-gt-gt&quot; class=&quot;headerlink&quot; title=&quot;Pollutants and Insecticides Drive Local Adaptation in African Malaria Mosquitoes &amp;gt;&amp;gt;&amp;gt;&quot;&gt;&lt;/a&gt;Pollutants and Insecticides Drive Local Adaptation in African Malaria Mosquitoes &lt;a href=&quot;https://academic.oup.com/mbe/article/34/5/1261/2996747/Pollutants-and-Insecticides-Drive-Local-Adaptation&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Mol Biol Evol (2017) 34 (5): 1261-1275.&lt;br&gt;对喀麦隆地区941只疟蚊进行简化基因组测序，得到8000个SNP标记。分析发现这些蚊子存在城市和乡村的群体遗传分化，城市污染地区的蚊子存在对杀虫剂的适应性。  &lt;/p&gt;
    
    </summary>
    
      <category term="paper_express" scheme="http://www.colyfu.com/categories/paper-express/"/>
    
    
      <category term="文献导读" scheme="http://www.colyfu.com/tags/%E6%96%87%E7%8C%AE%E5%AF%BC%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>python按指定分隔符读取文件</title>
    <link href="http://www.colyfu.com/programming/blockread-python.html"/>
    <id>http://www.colyfu.com/programming/blockread-python.html</id>
    <published>2017-05-27T11:46:02.000Z</published>
    <updated>2017-05-27T11:48:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>在处理一些结构化的文件，如fasta文件，我们往往需要读完一条记录再进行处理，如计算每条序列的长度，GC含量等等。这个时候通常的做法是按行读，先把内容存在一个临时变量，直到读到下一个区块分隔符（如fasta文件的‘&gt;‘）的时候再处理上一条记录。如果文件不大，也可以一次读进内存，然后用split分割。前一种方法逻辑有点绕，而且容易忘记处理最后一条记录。而后一种方法对于大文件的处理就不适用了。</p>
<a id="more"></a>
<p>有没有什么方法让python以指定的分隔符读文件，而不是默认的换行符呢？我们知道perl有内建的<code>$/</code>变量来修改perl的默认文件分隔符，如设置<code>$/=&#39;&gt;&#39;</code>后，perl就可以每次读一条fasta记录。但是据我了解，python并没有类似的内建方法。这里提供一个十分方便的函数来按指定分隔符读文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">blockread</span><span class="params">(fh, sep)</span>:</span></div><div class="line">    buf = <span class="string">""</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">while</span> sep <span class="keyword">in</span> buf:</div><div class="line">            pos = buf.index(sep)</div><div class="line">            <span class="keyword">yield</span> buf[:pos]</div><div class="line">            buf = buf[pos + len(sep):]</div><div class="line">        chunk = fh.read(<span class="number">4096</span>)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chunk:</div><div class="line">            <span class="keyword">yield</span> buf</div><div class="line">            <span class="keyword">break</span></div><div class="line">        buf += chunk</div></pre></td></tr></table></figure>
<p>函数第一个参数为文件句柄，第二个参数为分隔符。如果我们想遍历一个fasta文件，每次读一条fasta记录，可以使用<code>for each in blockread(open(&#39;filename&#39;), &#39;&gt;&#39;):</code>。该函数主要是用到<code>yield</code>来生成一个可迭代对象。函数的分隔符需要是字符串，经过简单修改，也可以用正则表达式作为分隔符。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在处理一些结构化的文件，如fasta文件，我们往往需要读完一条记录再进行处理，如计算每条序列的长度，GC含量等等。这个时候通常的做法是按行读，先把内容存在一个临时变量，直到读到下一个区块分隔符（如fasta文件的‘&amp;gt;‘）的时候再处理上一条记录。如果文件不大，也可以一次读进内存，然后用split分割。前一种方法逻辑有点绕，而且容易忘记处理最后一条记录。而后一种方法对于大文件的处理就不适用了。&lt;/p&gt;
    
    </summary>
    
      <category term="programming" scheme="http://www.colyfu.com/categories/programming/"/>
    
    
      <category term="python" scheme="http://www.colyfu.com/tags/python/"/>
    
      <category term="文件分隔符" scheme="http://www.colyfu.com/tags/%E6%96%87%E4%BB%B6%E5%88%86%E9%9A%94%E7%AC%A6/"/>
    
  </entry>
  
  <entry>
    <title>群体模拟软件ms使用说明</title>
    <link href="http://www.colyfu.com/Population-Genetics/ms-simulation.html"/>
    <id>http://www.colyfu.com/Population-Genetics/ms-simulation.html</id>
    <published>2017-05-27T07:21:17.000Z</published>
    <updated>2017-05-27T07:33:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://home.uchicago.edu/rhudson1/source/mksamples.html" target="_blank" rel="external">ms</a>是中性进化条件下，群体数据模拟最常用的软件。群体数据模拟在群体遗传学研究中非常重要，可以用来评估各统计量的可靠性，研究某种群体历史下各统计量的估计值，帮助我们理解真实数据所经历的群体历史。</p>
<p>基本用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ms nsam nreps -t θ</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>nsam为模拟的样本数量(单倍型)，nreps为模拟的DNA片段数量，各片段之间不存在连锁。这两个参数为必需的。θ为突变参数，θ=4N<sub>0</sub>μL，详见下面参数解释。</p>
<p>输出文件如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">ms 4 2 -t 5.0</div><div class="line">27473 36154 10290</div><div class="line">//</div><div class="line">segsites: 4</div><div class="line">positions: 0.0110 0.0765 0.6557 0.7571</div><div class="line">0010</div><div class="line">0100</div><div class="line">0000</div><div class="line">1001</div><div class="line">//</div><div class="line">segsites: 5</div><div class="line">positions: 0.0491 0.2443 0.2923 0.5984 0.8312</div><div class="line">00001</div><div class="line">00000</div><div class="line">00010</div><div class="line">11110</div></pre></td></tr></table></figure>
<p>第一行为命令行。<br>第二行为随机数种子，用该随机数种子可以重复模拟的结果。<br>之后的数据以‘//’分隔各DNA片段。每个片段第一部分为分离位点数。第二部分为这些分离位点的相对位置，0～1之间，默认保留4位小数，可以用-p n 来修改精度，n为保留的小数位数。第三部分为基因型，每一行为一个单倍型，祖先型用0表示，突变用1表示。</p>
<h3 id="各参数含义"><a href="#各参数含义" class="headerlink" title="各参数含义"></a>各参数含义</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="_">-f</span> filename  <span class="comment"># 参数文件，ms可以从文件读取除nsam, nreps之外的其它参数</span></div><div class="line">-seeds x1 x2 x3  <span class="comment"># 随机数种子，3个整数，一样的随机数种子可以重复结果，缺省后ms使用默认随机数种子</span></div><div class="line">-t θ  <span class="comment"># 突变率，θ=4NμL, N为二倍体群体大小, μ为突变率，L为模拟的DNA片段长度。</span></div><div class="line"><span class="_">-s</span> int <span class="comment"># 每个DNA片段生成固定的分离位点数，如果我们要模拟不连锁的SNPs，可以设置-s 1。</span></div><div class="line">-T  <span class="comment"># 输出系统发育树，newick格式。</span></div><div class="line">-L  <span class="comment"># 输出最近共同祖先的时间及总枝长，单位是4N generation。</span></div><div class="line">-p int  <span class="comment"># 保留小数位数，默认是4</span></div><div class="line">-r ρ nsites <span class="comment"># ρ=4Nr，r为模拟DNA片段两末端之间的重组率，nsites为DNA片段长度。</span></div><div class="line">-c f λ  <span class="comment"># 基因转换, f=g/r, g为每碱基转换率，如果r=0，则f=4Ng，λ为平均基因转换长度，即使ρ=0，nsites也要通过-c指定。</span></div><div class="line">-G α  <span class="comment"># 将所有群体的增长率设为α，群体呈指数增长，α为自然数e的幂。时间的单位为4N generation。</span></div><div class="line">-I npop n1 n2 ...[4Nm]  <span class="comment"># 设定一共npop个群体，每个群体的样本数分别为n1，n2 ...，群体的总基因流为4Nm，默认为0。注意，每个群体之间的基因流为4Nm/(npop-1)。</span></div><div class="line">    -n i x  <span class="comment"># 设置第i个群体大小为x*N。</span></div><div class="line">    -g i a_i  <span class="comment"># 设置第i个群体的增长率为a_i。</span></div><div class="line">    -m i j Mij  <span class="comment"># 设置群体j到群体i的基因流为Mij，单位为4N generation。</span></div><div class="line">    -ma M11, M12...M21, M22...  <span class="comment"># 设置基因流矩阵。i=j的时候，是没有任何意义的，ms会忽略，可以用x代替。</span></div><div class="line"><span class="_">-e</span>G t a  <span class="comment"># 设置时间t的时候，所有群体的增长率，注意ms模拟的逻辑是backward，所有的时间都是距离当前的时间，单位为4N generation。</span></div><div class="line">-eg t i ai <span class="comment"># 设置时间t的时候，i群体的增长率为ai。</span></div><div class="line"><span class="_">-e</span>N t x  <span class="comment"># 设置时间t的时候，所有群体的大小为x*N，注意，此设置默认效果是所有群体的增长率变为0。因此，要使同一时间的增长率生效，增长率设置要在群体大小设置之后。</span></div><div class="line">-en t i x  <span class="comment"># 设置i亚群的增长率，效果同上。</span></div><div class="line"><span class="_">-e</span>M t x  <span class="comment"># 设置t时间所有群体之间的基因流为x/(npop-1)。</span></div><div class="line">-em t i j x  <span class="comment"># 设置时间t，j 到i的基因流4Nmij=x。</span></div><div class="line">-ema t npop M11, M12...  <span class="comment"># 设置t时间的基因流矩阵。</span></div><div class="line">-es t i p  <span class="comment"># t时间i群体分为i和npop+1两个亚群，i中每个个体分到新i的概率为p，分到npop+1的概率为1-p。新群体的基因流和增长率都为0，群体大小设为N，i群体的基因流增长率不变。从正向历史来看，这是一个admixture事件。</span></div><div class="line">-ej t i j  <span class="comment"># t时间，i群体所有个体合并到j群体，i群体到其它群体的基因流都变为0，增长率不变。从正向历史来看，这是一个群体分化事件。</span></div></pre></td></tr></table></figure>
<p><em>注: 以上N皆指</em> N<sub>0</sub>， <em>因为在markdown的代码块里面，html标记不生效</em></p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><h4 id="1-群体大小瞬间收缩然后指数扩增"><a href="#1-群体大小瞬间收缩然后指数扩增" class="headerlink" title="1. 群体大小瞬间收缩然后指数扩增"></a>1. 群体大小瞬间收缩然后指数扩增</h4><p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/msdoc_fig1.png" width="400"><br></p>

<p>图中N<sub>1</sub>=10,000，N<sub>2</sub>=5,000，N<sub>3</sub>=20,000，如果突变率为每代10<sup>-8</sup>，如果模拟的DNA片段长度为8,000 bp，将N<sub>0</sub>设置为20,000，则θ=4*20000*10<sup>-8</sup>*8000=6.40，如果T1是16000代，则转为4N<sub>0</sub>代单位为16000/(4*20000)=0.2，T2为24000代，即0.3以4N<sub>0</sub>代为单位。5000=20000*exp<sup>-a0.2</sup>，算出a为6.93。如果该群体取15个样本，模拟1000个DNA片段，ms命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ms 15 1000 -t 6.4 -G 6.93 <span class="_">-e</span>G 0.2 0.0 <span class="_">-e</span>N 0.3 0.5</div></pre></td></tr></table></figure></p>
<h4 id="2-两个群体分化后经历不同的群体大小变化"><a href="#2-两个群体分化后经历不同的群体大小变化" class="headerlink" title="2. 两个群体分化后经历不同的群体大小变化"></a>2. 两个群体分化后经历不同的群体大小变化</h4><p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/msdoc_fig2.png" width="400"><br></p>

<p>各个参数的计算参考1，不再赘述，只给每个模型的ms命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ms 15 100 -t 11.2 -I 2 3 12 -g 1 44.36 -n 2 0.125 -eg 0.03125 1</div><div class="line">0.0 -en 0.0625 2 0.05 -ej 0.09375 2 1</div></pre></td></tr></table></figure>
<h4 id="3-近期隔离的踏脚石模型"><a href="#3-近期隔离的踏脚石模型" class="headerlink" title="3. 近期隔离的踏脚石模型"></a>3. 近期隔离的踏脚石模型</h4><p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/ms_fig3.png" width="400"><br></p>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ms 15 100 -t 3.0 -I 6 0 7 0 0 8 0 -m 1 2 2.5 -m 2 1 2.5 -m 2 3 2.5</div><div class="line">-m 3 2 2.5 -m 4 5 2.5 -m 5 4 2.5 -m 5 6 2.5 -m 6 5 2.5 -em 2.0 3 4</div><div class="line">2.5 -em 2.0 4 3 2.5</div></pre></td></tr></table></figure>
<h4 id="4-近期Admixture事件"><a href="#4-近期Admixture事件" class="headerlink" title="4. 近期Admixture事件"></a>4. 近期Admixture事件</h4><p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/dog_fig3.png" width="400"><br></p>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ms 76 50000 <span class="_">-s</span> 1 -I 17 24 22 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \</div><div class="line">-n 1 1 -n 2 0.3333 -n 3 0.25 -n 4 0.25 -n 5 0.2 -n 6 0.2 -n 7 0.2 -n 8 0.2 \</div><div class="line">-n 9 0.2 -n 10 0.2 -n 11 0.2 -n 12 0.2 -n 13 0.2 -n 14 0.2 -n 15 0.2 \</div><div class="line">-n 16 0.2 -n 17 0.2 \</div><div class="line">-es 0.0003125 5 0.5 -en 0.0003125 5 0.2 -ej 0.0003125 18 2 \</div><div class="line">-es 0.0003125 6 0.5 -en 0.0003125 6 0.2 -ej 0.0003125 19 2 \</div><div class="line">-ej 0.01041667 6 5 -ej 0.01041667 7 5 -ej 0.01041667 8 5 -ej 0.01041667 9 5 \</div><div class="line">-ej 0.01041667 10 5 -ej 0.01041667 11 5 -ej 0.01041667 12 5 \</div><div class="line">-ej 0.01041667 13 5 -ej 0.01041667 14 5 -ej 0.01041667 15 5 \</div><div class="line">-ej 0.01041667 16 5 -ej 0.01041667 17 5 -ej 0.01354167 5 4 \</div><div class="line">-ej 0.01458333 4 3 -ej 0.015625 3 2 -ej 0.034375 2 1</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://home.uchicago.edu/rhudson1/source/mksamples.html&quot;&gt;ms&lt;/a&gt;是中性进化条件下，群体数据模拟最常用的软件。群体数据模拟在群体遗传学研究中非常重要，可以用来评估各统计量的可靠性，研究某种群体历史下各统计量的估计值，帮助我们理解真实数据所经历的群体历史。&lt;/p&gt;
&lt;p&gt;基本用法：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ms nsam nreps -t θ&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Population_Genetics" scheme="http://www.colyfu.com/categories/Population-Genetics/"/>
    
    
      <category term="ms软件" scheme="http://www.colyfu.com/tags/ms%E8%BD%AF%E4%BB%B6/"/>
    
      <category term="模拟" scheme="http://www.colyfu.com/tags/%E6%A8%A1%E6%8B%9F/"/>
    
      <category term="中性进化" scheme="http://www.colyfu.com/tags/%E4%B8%AD%E6%80%A7%E8%BF%9B%E5%8C%96/"/>
    
      <category term="群体遗传学" scheme="http://www.colyfu.com/tags/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>主成分分析及其解读</title>
    <link href="http://www.colyfu.com/Population-Genetics/pca-interpret.html"/>
    <id>http://www.colyfu.com/Population-Genetics/pca-interpret.html</id>
    <published>2017-05-15T14:32:26.000Z</published>
    <updated>2017-05-15T14:52:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>主成分分析是群体遗传学中常用的分析手段，一般用来 1)分析群体中存在的群体结构(分层)； 2) 推断群体历史； 3) 关联分析中对群体结构进行校正。目前用于主成分分析的数据主要为高密度的SNP标记，其主要思想是将多个线性相关的变量(SNP)，通过一系列矩阵转换，变成少数几个变异解释度大的线性无关变量(特征向量)。  </p>
<p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/pca.png" width="400"><br></p>

<a id="more"></a>
<ul>
<li><h3 id="主成分分析软件"><a href="#主成分分析软件" class="headerlink" title="主成分分析软件"></a>主成分分析软件</h3></li>
</ul>
<p>主成分分析的软件非常多，R中的prcomp函数即可进行。但是对于群体遗传学中多样本(几百甚至几千)，高密度SNP标记（几百万）需要太多内存和时间，甚至根本不能完成。这里推荐两个比较好用的软件<a href="https://www.hsph.harvard.edu/alkes-price/software/" target="_blank" rel="external">smartpca</a>(EIGENSOFT软件包中)和<a href="https://github.com/gabraham/flashpca" target="_blank" rel="external">flashpca</a>。下面以smartpca为例简单说明一下主成分分析。  </p>
<p>主成分分析过程中，基因型数据要转换为[0, 1, 2]离散变量，表示某样本某位点相对参考序列突变allele数，因此只能分析二倍体<strong>双等位</strong>基因数据(smartpca也可以分析SSR数据)。n个样本，m个SNPs，既生成n x m矩阵。smartpca在计算过程中，每列需要标准化，即矩阵中每个数字要减去该列平均数u<sub>j</sub>，同时除以u<sub>j</sub>的一个函数，因此每列的和为0，自由度变为n-1，所以smartpca算出来的特征值和特征向量都是n-1个。  </p>
<p>smartpca的输入文件支持5种格式，可以用EIGENSOFT软件包中的convertf程序相互转换。其中最通用，最方便我们使用的就是PLINK的ped格式文件。smartpca软件运行命令行：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">smartpca -p smartpca.par &gt; pca.log</div></pre></td></tr></table></figure>
<p><code>smartpca.par</code>为参数配置文件，示例如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">genotypename: sample159.ped</div><div class="line">snpname:      sample159.pedsnp</div><div class="line">indivname:    sample159.pedind</div><div class="line">evecoutname:  sample159.pca.vec</div><div class="line">evaloutname:  sample159.pca.val</div><div class="line">numoutlieriter: 0</div><div class="line">poplistname: pops</div><div class="line">numchrom: 22</div></pre></td></tr></table></figure>
<p>其中<code>sample159.ped</code>为PLINK格式ped文件，<strong>注意</strong>smartpca从该文件第6列读取群体信息，如果用vcftools转为PLINK格式ped文件，该列默认为-9，如果有群体信息，将该列改为相应的群体ID，如果没有，请将该列改为‘1’，如果该列为’0’, ‘9’, ‘-9’则表示过滤掉相应个体。<code>sample159.pedsnp</code>为PLINK格式map文件，<code>sample159.pedind</code>文件为<code>sample159.ped</code>文件的1～6列。<strong>注意</strong>，这3个文件的后缀不能改变，smartpca从文件后缀判断文件格式。*.vec和 *.val为特征向量和特征值的输出文件，<code>numoutlieriter</code>参数表示进行几次异常样本去除。如果只想用一部分群体进行PCA分析，将另外的个体<strong>映射</strong>到该变量空间，可以将进行PCA分析的群体ID放在<code>poplistname</code>参数的文件中，每个群体ID一行，其它个体将影射到这些群体的变量空间。<code>numchrom</code>为最大常染色体编号，<strong>超过该值的其它染色体将忽略</strong>。  </p>
<p>smartpca程序分析结束后，就可以用特征向量*.vec文件进行画图。该文件特征向量按解释度大小从左到右排列。一般用前3个主成分进行画图展示。</p>
<ul>
<li><h3 id="主成分分析判断群体结构"><a href="#主成分分析判断群体结构" class="headerlink" title="主成分分析判断群体结构"></a>主成分分析判断群体结构</h3></li>
</ul>
<p>主成分分析的结果可以用来判断是否存在群体结构（分层），如果亚群之间的差异比较大，我们可以看到不同的亚群会形成各自的cluster，如上图。有些群体可能差异比较小，很难通过眼睛判断是否存在群体结构，那么是否有定量的检验方法呢？  </p>
<p>smartpca提供Tracy-Widom检验来判断在每一个主成分上是否群体存在显著分层，该检验的P值输出在log文件中。一般两个群体之间的Fst大于0.005时，Tracy-Widom检验就会十分显著。</p>
<ul>
<li><h3 id="主成分分析推断群体历史"><a href="#主成分分析推断群体历史" class="headerlink" title="主成分分析推断群体历史"></a>主成分分析推断群体历史</h3><ol>
<li>admixture事件  </li>
</ol>
<p>如下图，如果A群体和B群体混合生成了C群体，那么PCA分析结果中，C群体会在AB的连线上，谁的比例多，离谁更近。但是如果该混合事件发生在很久以前，由于混合群体经历了自己特有的遗传漂变，会逐渐偏离该连线。 </p>
<p align="center"><br><img src="http://onzjn6hm6.bkt.clouddn.com/pca_sim.png" width="400"><br></p>

<p>混合事件不会改变变量空间，即上面的ABCD群体和ABD群体进行PCA分析，所得到的显著主成分一样多。</p>
<ol>
<li>migration事件</li>
</ol>
<p>如果PCA呈线性分布，与群体的地理分布距离一致，那很有可能说明了该物种的迁徙历史。如下图，左下方彩色的点表示的是狗，该分布就呈线性，与狗从亚洲东南部，经过中亚向欧洲扩散的历史相吻合。</p>
<p align="center"><br><img src="http://onzjn6hm6.bkt.clouddn.com/pca_zhang.png" width="500"><br></p>

<p>下图用撒哈拉以南的非洲人群体作为变量空间进行PCA分析，将其它人群体映射到该变量空间，发现所有其它非撒哈拉以南非洲人群体都聚在一起，暗示了人类从南非的一次迁出。  </p>
<p align="center"><br><img src="http://onzjn6hm6.bkt.clouddn.com/pca_sahara.png" width="400"><br></p>

<p>需要注意的是，PCA呈线性分布并非一定是migration造成的，isolation by distance也会形成该结构。所以要结合其它分析进行判断。</p>
<p>长的LD片段会影响PCA分析，因此高密度的SNP数据，需要进行LD过滤（LD-based SNP Prunning）。</p>
</li>
<li><h3 id="利用PCA结果对关联分析进行群体结构校正"><a href="#利用PCA结果对关联分析进行群体结构校正" class="headerlink" title="利用PCA结果对关联分析进行群体结构校正"></a>利用PCA结果对关联分析进行群体结构校正</h3></li>
</ul>
<p>一般用前几个主成分进行校正，关联分析软件GAPIT可以实现，在以后GWAS专题会总结，这里不细说。</p>
<p>需要注意的是，用PCA进行校正的时候，最好只用与表型相关的主成分校正，不然很容易校正过度，导致模型失去power。</p>
<p><strong>参考文献：</strong></p>
<p><a href="http://www.nature.com/ng/journal/v40/n5/abs/ng0508-491.html" target="_blank" rel="external">Principal component analysis of genetic data</a></p>
<p><a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.0020190" target="_blank" rel="external">Population Structure and Eigenanalysis</a></p>
<p><a href="http://www.nature.com/ng/journal/v40/n5/abs/ng.139.html" target="_blank" rel="external">Interpreting principal component analyses of spatial<br>population genetic variation</a></p>
<p><a href="http://www.nature.com/cr/journal/v26/n1/full/cr2015147a.html" target="_blank" rel="external">Out of southern East Asia: the natural history of domestic<br>dogs across the world</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;主成分分析是群体遗传学中常用的分析手段，一般用来 1)分析群体中存在的群体结构(分层)； 2) 推断群体历史； 3) 关联分析中对群体结构进行校正。目前用于主成分分析的数据主要为高密度的SNP标记，其主要思想是将多个线性相关的变量(SNP)，通过一系列矩阵转换，变成少数几个变异解释度大的线性无关变量(特征向量)。  &lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;br&gt;  &lt;img src=&quot;http://onzjn6hm6.bkt.clouddn.com/pca.png&quot; width=&quot;400&quot;/&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Population_Genetics" scheme="http://www.colyfu.com/categories/Population-Genetics/"/>
    
    
      <category term="主成分分析" scheme="http://www.colyfu.com/tags/%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90/"/>
    
      <category term="映射" scheme="http://www.colyfu.com/tags/%E6%98%A0%E5%B0%84/"/>
    
      <category term="群体结构" scheme="http://www.colyfu.com/tags/%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84/"/>
    
      <category term="迁徙" scheme="http://www.colyfu.com/tags/%E8%BF%81%E5%BE%99/"/>
    
      <category term="基因流" scheme="http://www.colyfu.com/tags/%E5%9F%BA%E5%9B%A0%E6%B5%81/"/>
    
      <category term="smartpca" scheme="http://www.colyfu.com/tags/smartpca/"/>
    
  </entry>
  
  <entry>
    <title>分染色体并行计算中科学分配任务</title>
    <link href="http://www.colyfu.com/programming/split-ref.html"/>
    <id>http://www.colyfu.com/programming/split-ref.html</id>
    <published>2017-05-08T12:29:46.000Z</published>
    <updated>2017-05-09T03:34:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>在生物信息分析过程中，为了加快运行速度，我们经常会采用分染色体计算的方式，即scatter/gather的思想。比如SNP calling, SNP phasing及imputation等。但怎样划分染色体，划分几个部分比较合适呢？</p>
<p>一般情况下，程序运行的时间和染色体长度成正比，而组装出来的染色体一般长度差异很大。在计算资源充足的情况下，一条染色体一个任务通常是最快的。如果任务存在排队，包含长染色体的任务如果排在后面，那需要的时间反而更多了。之前供职的公司，流程采用随机分成染色体数目相等的N份，但存在一些问题：1）N为多少合适？多了如果任务有排队，一条染色体一个任务不一定快，还比较浪费计算资源。分太少又需要更多计算时间。2）随机分配，很有可能将两条较长的染色体分在一个任务中。  </p>
<a id="more"></a>
<p>很多人想到了，既然程序运行时间和染色体长度成正比，那保证每份任务所分配的染色体总长相等不就可以了吗？确实是这样，这里有一个前提，即染色体不能打断，因为打断后，有些计算可能出问题，比如断点处存在变异，比如计算ROH、IBD等。  </p>
<p>这里提供一种比较科学的解决办法：将该问题视为简单的一维装箱问题，箱子的大小即最长染色体的长度，利用贪婪算法解决这个装箱问题。如果最长的染色体计算时间是最长的，这样其它任务都不会超过这个时间，而且保证了分配的任务数量相对少（贪婪算法的结果很有可能不是全局最优解，但是好在算法简单，相对最优的结果也可以接受）。python实现如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">SplitFai</span><span class="params">(fai, outdir, size=<span class="number">0</span>)</span>:</span></div><div class="line">    chrs = []</div><div class="line">    flist = []</div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> open(fai):</div><div class="line">        info = line.strip().split()[<span class="number">0</span>:<span class="number">2</span>]</div><div class="line">        chrs += [[info[<span class="number">0</span>], int(info[<span class="number">1</span>])]]</div><div class="line"></div><div class="line">    chrs = sorted(chrs, key=<span class="keyword">lambda</span> a: a[<span class="number">1</span>], reverse=<span class="keyword">True</span>)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> size:</div><div class="line">        size = chrs[<span class="number">0</span>][<span class="number">1</span>]</div><div class="line">    <span class="keyword">elif</span> size &lt; chrs[<span class="number">0</span>][<span class="number">1</span>]:</div><div class="line">       sys.stderr.write(<span class="string">'Error: size is short than the longest chromosome!'</span>)</div><div class="line">       sys.exit(<span class="number">0</span>)</div><div class="line"></div><div class="line">    count = <span class="number">0</span> </div><div class="line">    <span class="keyword">while</span> chrs:</div><div class="line">        fo = open(outdir+<span class="string">'/gemone.split_'</span>+str(count)+<span class="string">'.list'</span>, <span class="string">'w'</span>)</div><div class="line">        flist.append(outdir+<span class="string">'/gemone.split_'</span>+str(count)+<span class="string">'.list'</span>)</div><div class="line">        lenC = <span class="number">0</span> </div><div class="line">        chrs_new = []</div><div class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> chrs:</div><div class="line">            <span class="keyword">if</span> size - lenC &gt;= each[<span class="number">1</span>]:</div><div class="line">                fo.write(each[<span class="number">0</span>] + <span class="string">'\n'</span>)</div><div class="line">                lenC += each[<span class="number">1</span>]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                chrs_new += [each]</div><div class="line"></div><div class="line">        chrs = chrs_new</div><div class="line">        count += <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> flist</div></pre></td></tr></table></figure>
<p>该函数有3个参数，第1个是参考序列的index文件，用<code>samtools faidx ref.fa</code>生成，该文件第一列为染色体名，第二列为染色体长度。第2个参数为输出目录，第3个参数为每份染色体总长度的上限，即箱子大小，默认为最长染色体长度。 <strong>注意，如果自己指定箱子大小，箱子大小必须超过最长染色体长度。</strong> 输出文件为每份包含的染色体ID。  </p>
<p>该函数的思路：将所有染色体按照长度从大到小排序。装箱的时候先尽量装大的，直到装不下再换新箱子。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在生物信息分析过程中，为了加快运行速度，我们经常会采用分染色体计算的方式，即scatter/gather的思想。比如SNP calling, SNP phasing及imputation等。但怎样划分染色体，划分几个部分比较合适呢？&lt;/p&gt;
&lt;p&gt;一般情况下，程序运行的时间和染色体长度成正比，而组装出来的染色体一般长度差异很大。在计算资源充足的情况下，一条染色体一个任务通常是最快的。如果任务存在排队，包含长染色体的任务如果排在后面，那需要的时间反而更多了。之前供职的公司，流程采用随机分成染色体数目相等的N份，但存在一些问题：1）N为多少合适？多了如果任务有排队，一条染色体一个任务不一定快，还比较浪费计算资源。分太少又需要更多计算时间。2）随机分配，很有可能将两条较长的染色体分在一个任务中。  &lt;/p&gt;
    
    </summary>
    
      <category term="programming" scheme="http://www.colyfu.com/categories/programming/"/>
    
    
      <category term="并行计算" scheme="http://www.colyfu.com/tags/%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97/"/>
    
      <category term="分染色体计算" scheme="http://www.colyfu.com/tags/%E5%88%86%E6%9F%93%E8%89%B2%E4%BD%93%E8%AE%A1%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>单体型网络（Haplotype Network）构建及展示</title>
    <link href="http://www.colyfu.com/Population-Genetics/haplotype-network.html"/>
    <id>http://www.colyfu.com/Population-Genetics/haplotype-network.html</id>
    <published>2017-05-07T16:24:35.000Z</published>
    <updated>2017-05-27T11:53:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>单体型网络（Haplotype Network）是谱系地理研究的重要手段。通过单体型网络，我们可以推断群体的起源、扩散历史。那么怎样理解单体型网络以及怎样构建单体型网络？</p>
<h3 id="什么是单体型网络？"><a href="#什么是单体型网络？" class="headerlink" title="什么是单体型网络？"></a>什么是单体型网络？</h3><p>单体型（haplotype）在单体型网络中是指一段遗传连锁的核酸序列。不同的单体型，通过序列中的变异来区分（常用SNP）。一般用来进行单体型网络构建的单体型有：1）线粒体基因组；2）Y染色体；3）叶绿体基因组；4）基因组上一段强连锁的区段。  </p>
<p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/haplotype_network.png" width="300"><br></p>

<a id="more"></a>
<p>上图是一个单体型网络的例子，图中一个圆圈表示一个单体型，两个圆圈之间的连线表示这两个单体型相关（一个是由另一个突变而来），连线上面的短竖线表示从一个单体型到与其相连的单体型需要经历的碱基替换数，一个竖线表示一个替换。彩色的圆圈表示我们实际取样到的单体型，圆圈大小表示这种单体型的个数。灰色圆圈表示推断出来可能存在的中间单体型，没有被取样到。一种颜色一般表示一个群体，如按地理划分，品种划分等。图中例子一个单体型只存在于一个群体中，实际情况一个单体型往往在多个群体中出现。此时，一个单体型圆圈中填充多种颜色，以饼图的形式展示。<br>从上图我们可以猜测一种可能的群体历史：A群体和C群体都起源于B群体，A群体从B群体分化出来后，经历过急剧的群体扩张，导致A群体的单体型演化出多个亚型。当然，为了避免过度解读，推断群体历史需要多种证据结合起来。</p>
<h3 id="构建单体型网络的工具"><a href="#构建单体型网络的工具" class="headerlink" title="构建单体型网络的工具"></a>构建单体型网络的工具</h3><p>比较经典的软件就是<a href="http://www.fluxus-engineering.com/sharenet.htm" target="_blank" rel="external">Network</a>了，但是该软件只支持Windows系统，用起来也比较复杂。这里推荐<a href="http://popart.otago.ac.nz/downloads.shtml" target="_blank" rel="external">PopART</a>，该软件支持Windows，Mac，Linux系统，而且用起来也非常方便，支持多种常用的Network构建方法，关键是该软件支持地图的形式展示单体型分布。下面简单介绍一下该软件的使用方法。<br>PopART的输入文件格式为NEXUS，一般主要用到两个部分DATA和TRAITS。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">#NEXUS</div><div class="line"></div><div class="line">begin data;</div><div class="line">dimensions ntax=4 nchar=30;</div><div class="line">format datatype=dna missing=N gap=-;</div><div class="line">matrix</div><div class="line">seq1 CCACCGTTGCTAAAAATTCATGACACAAGG</div><div class="line">seq2 CCACAGTTTCTAAAAATTCGTGATACAAGG</div><div class="line">seq3 CCACAGTTGCTACAAATTCATGATACAAGG</div><div class="line">seq4 CCACAGGTGCTAAAAATTCATGAAACAAGG</div><div class="line">;</div><div class="line">end;</div><div class="line"></div><div class="line">BEGIN TRAITS;</div><div class="line">    Dimensions NTRAITS=5;</div><div class="line">    Format labels=yes missing=? separator=Comma;</div><div class="line">    TraitLatitude 53 43.6811 5.4 -25.61 -0;</div><div class="line">    TraitLongitude 16.75 87.3311 26.5 134.355 -76;</div><div class="line">    TraitLabels Europe Asia Africa Australia America;</div><div class="line">    Matrix</div><div class="line">    seq1 10,5,0,6,0</div><div class="line">    seq2 0,0,5,0,0</div><div class="line">    seq3 4,0,10,0,0</div><div class="line">    seq4 0,0,0,4,2</div><div class="line">    ;</div><div class="line">END;</div></pre></td></tr></table></figure>
<p>DATA部分主要纪录单体型信息，比较好理解。TRAITS部分主要纪录单体型来源的群体。如上所示，例子中取了来自5个大洲的样本，一共4种单体型，TRAITS纪录了每种单体型在不同大洲取样的个数，如<code>seq1</code>在<code>Europe</code>有10个，在<code>Asia</code>有5个等等。关键字TraitLatitude和TraitLongitude纪录5个群体取样地点的经纬度，该信息在单体型网络构建中可以不用，当需要用地图展示单体型地理分布时，需要填该信息。NEXUS文件生成后，打开PopART，通过<code>File -&gt; Open</code>输入NEXUS文件，然后通过菜单栏<code>Network</code>选择单体型网络构建算法，如常用的Median Joining Network。选择Median Joining Network后，会提示填写Epsilon参数，该参数用来控制推断中间单体型的细节程度，该值越大，会展示更多推断的中间单体型，一般选择默认的0就好。填好该参数后，点击<code>OK</code>，就生成了我们需要的单体型网络。然后通过菜单栏<code>Edit</code>下的选项，对图中群体的颜色、字体、图例等进行调整。<br>下面介绍一下PopART的单体型地理分布展示。</p>
<p></p><p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/network_map.png" width="300"><br></p><br>点击<code>View -&gt; Switch to map view</code>就可以得到如上所示的单体型地理分布图。通过单体型的地理分布直观展示，我们就可以对群体的扩散迁徙途径进行推断。<p></p>
<h3 id="单体型序列的获得"><a href="#单体型序列的获得" class="headerlink" title="单体型序列的获得"></a>单体型序列的获得</h3><p>像线粒体、叶绿体、Y染色体等这些在遗传过程中不发生重组的序列，我们直接把检测到的变异替换到参考序列中，就可以用于单体型网络构建。但是通常研究的二倍体基因组数据，由于存在重组，因此不能简单的拿一段序列就进行单体型网络构建，这样的单体型网络就失去了它本身的意义。如要用基因组上面的序列，可以通过以下步骤：  </p>
<ol>
<li>找到基因组上强连锁的区段；</li>
<li>对这段区域中的SNP进行phase；</li>
</ol>
<p>第一步可以用<a href="https://www.cog-genomics.org/plink2" target="_blank" rel="external">PLINK</a>，命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plink --noweb --bfile bed_prefix --blocks no-pheno-req</div></pre></td></tr></table></figure></p>
<p>该命令运行会生成<code>.blocks.det</code>文件，该文件纪录了强连锁区段的起止位置、所包含的SNP。接下来，我们需要对感兴趣的强连锁区域的杂合SNP进行phase，构建单体型，该步可以使用软件BEAGLE。<br>第二步，使用<a href="单体型网络（Haplotype Network）构建及展示">BEAGLE</a>进行phase：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -Xss5m -Xmx4g -jar beagle.jar gt=prefix.vcf out=phased.vcf chrom=[chr]:[start]-[end]</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;单体型网络（Haplotype Network）是谱系地理研究的重要手段。通过单体型网络，我们可以推断群体的起源、扩散历史。那么怎样理解单体型网络以及怎样构建单体型网络？&lt;/p&gt;
&lt;h3 id=&quot;什么是单体型网络？&quot;&gt;&lt;a href=&quot;#什么是单体型网络？&quot; class=&quot;headerlink&quot; title=&quot;什么是单体型网络？&quot;&gt;&lt;/a&gt;什么是单体型网络？&lt;/h3&gt;&lt;p&gt;单体型（haplotype）在单体型网络中是指一段遗传连锁的核酸序列。不同的单体型，通过序列中的变异来区分（常用SNP）。一般用来进行单体型网络构建的单体型有：1）线粒体基因组；2）Y染色体；3）叶绿体基因组；4）基因组上一段强连锁的区段。  &lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;br&gt;  &lt;img src=&quot;http://onzjn6hm6.bkt.clouddn.com/haplotype_network.png&quot; width=&quot;300&quot;/&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Population_Genetics" scheme="http://www.colyfu.com/categories/Population-Genetics/"/>
    
    
      <category term="Haplotype Network" scheme="http://www.colyfu.com/tags/Haplotype-Network/"/>
    
      <category term="单体型网络" scheme="http://www.colyfu.com/tags/%E5%8D%95%E4%BD%93%E5%9E%8B%E7%BD%91%E7%BB%9C/"/>
    
      <category term="PopART" scheme="http://www.colyfu.com/tags/PopART/"/>
    
      <category term="谱系地理" scheme="http://www.colyfu.com/tags/%E8%B0%B1%E7%B3%BB%E5%9C%B0%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>文献速递 (2017年4月)</title>
    <link href="http://www.colyfu.com/paper-express/paper-express-201704.html"/>
    <id>http://www.colyfu.com/paper-express/paper-express-201704.html</id>
    <published>2017-05-02T14:16:47.000Z</published>
    <updated>2017-05-27T11:53:55.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="The-Rice-Paradox-Multiple-Origins-but-Single-Domestication-in-Asian-Rice"><a href="#The-Rice-Paradox-Multiple-Origins-but-Single-Domestication-in-Asian-Rice" class="headerlink" title="The Rice Paradox: Multiple Origins but Single Domestication in Asian Rice"></a><a href="https://academic.oup.com/mbe/article/34/4/969/2897272/The-Rice-Paradox-Multiple-Origins-but-Single" target="_blank" rel="external">The Rice Paradox: Multiple Origins but Single Domestication in Asian Rice</a></h4><p>Mol Biol Evol (2017) 34 (4): 969-979.<br>通过对几种栽培水稻和野生祖先的基因组比较，发现不同栽培稻亚种分别来自不同的野生祖先，但是只经历了一次驯化事件。<br>最先被驯化的是<em>O. sativa</em> ssp. japonica，与<em>O. rufipogon</em>大概在∼13.1–24.1 ka前分歧。japonica与indica和aus的驯化前体存在基因流，导致后两者获得了驯化基因型。</p>
<h4 id="Genome-Sequencing-Reveals-the-Origin-of-the-Allotetraploid-Arabidopsis-suecica"><a href="#Genome-Sequencing-Reveals-the-Origin-of-the-Allotetraploid-Arabidopsis-suecica" class="headerlink" title="Genome Sequencing Reveals the Origin of the Allotetraploid Arabidopsis suecica"></a><a href="https://academic.oup.com/mbe/article/34/4/957/2838775/Genome-Sequencing-Reveals-the-Origin-of-the" target="_blank" rel="external">Genome Sequencing Reveals the Origin of the Allotetraploid Arabidopsis suecica</a></h4><p>Mol Biol Evol (2017) 34 (4): 957-968.<br>对15个异源四倍体拟南芥<em>Arabidopsis suecica</em>进行了重测序。发现其与多个祖先物种共享多态性，排除了单一起源。该物种大概在末次盛冰期(LGM)的东欧或欧亚大陆中部出现。还发现两个自交不亲和基因都没有功能。</p>
<a id="more"></a>
<h4 id="Deleterious-Variants-in-Asian-Rice-and-the-Potential-Cost-of-Domestication"><a href="#Deleterious-Variants-in-Asian-Rice-and-the-Potential-Cost-of-Domestication" class="headerlink" title="Deleterious Variants in Asian Rice and the Potential Cost of Domestication"></a><a href="https://academic.oup.com/mbe/article-abstract/34/4/908/2897207/Deleterious-Variants-in-Asian-Rice-and-the?redirectedFrom=fulltext" target="_blank" rel="external">Deleterious Variants in Asian Rice and the Potential Cost of Domestication</a></h4><p>Mol Biol Evol (2017) 34 (4): 908-924.<br>通过与野生种的比较，发现驯化种积累了更多(∼3–4%)的有害SNPs。这些有害SNPs 主要集中在低重组率的区域。在受选择区域，有害SNPs的频率增加和同义SNPs相近。驯化导致水稻从异交向以自交为主转变。</p>
<h4 id="A-Working-Model-of-the-Deep-Relationships-of-Diverse-Modern-Human-Genetic-Lineages-Outside-of-Africa"><a href="#A-Working-Model-of-the-Deep-Relationships-of-Diverse-Modern-Human-Genetic-Lineages-Outside-of-Africa" class="headerlink" title="A Working Model of the Deep Relationships of Diverse Modern Human Genetic Lineages Outside of Africa "></a><a href="https://academic.oup.com/mbe/article/34/4/889/2838774/A-Working-Model-of-the-Deep-Relationships-of" target="_blank" rel="external">A Working Model of the Deep Relationships of Diverse Modern Human Genetic Lineages Outside of Africa </a></h4><p>Mol Biol Evol (2017) 34 (4): 889-902.<br>人类走出非洲后，目前的遗传结构是怎样建立的，一直是人类历史研究的主要兴趣点。<br>本文作者提出了一个模型，能够很好的拟合各人群体（东亚，澳大利亚，美国本土，古欧亚大陆西部和北部）的基因型频率数据。</p>
<h4 id="What-is-adaptation-by-natural-selection-Perspectives-of-an-experimental-microbiologist"><a href="#What-is-adaptation-by-natural-selection-Perspectives-of-an-experimental-microbiologist" class="headerlink" title="What is adaptation by natural selection? Perspectives of an experimental microbiologist"></a><a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006668" target="_blank" rel="external">What is adaptation by natural selection? Perspectives of an experimental microbiologist</a></h4><p>PLoS Genet 13(4): e1006668.<br>微生物对自然选择适应的综述。微生物实验进化学。</p>
<h4 id="Evolutionary-history-of-Tibetans-inferred-from-whole-genome-sequencing"><a href="#Evolutionary-history-of-Tibetans-inferred-from-whole-genome-sequencing" class="headerlink" title="Evolutionary history of Tibetans inferred from whole-genome sequencing"></a><a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006675" target="_blank" rel="external">Evolutionary history of Tibetans inferred from whole-genome sequencing</a></h4><p> PLoS Genet 13(4): e1006675.<br> 通过对27个藏族人的全基因组测序，揭示其群体历史和受选择基因。</p>
<h4 id="The-time-and-place-of-European-admixture-in-Ashkenazi-Jewish-history"><a href="#The-time-and-place-of-European-admixture-in-Ashkenazi-Jewish-history" class="headerlink" title="The time and place of European admixture in Ashkenazi Jewish history"></a><a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1006644" target="_blank" rel="external">The time and place of European admixture in Ashkenazi Jewish history</a></h4><p>PLoS Genet 13(4): e1006644.<br>推断德系犹太人的历史。用了一些新的推断方法。</p>
<h4 id="RECKONER-read-error-corrector-based-on-KMC"><a href="#RECKONER-read-error-corrector-based-on-KMC" class="headerlink" title="RECKONER: read error corrector based on KMC"></a><a href="https://academic.oup.com/bioinformatics/article-abstract/33/7/1086/2843893/RECKONER-read-error-corrector-based-on-KMC?redirectedFrom=fulltext" target="_blank" rel="external">RECKONER: read error corrector based on KMC</a></h4><p>Bioinformatics (2017) 33 (7): 1086-1089.<br>对测序的reads质量进行矫正。</p>
<h4 id="SVScore-an-impact-prediction-tool-for-structural-variation"><a href="#SVScore-an-impact-prediction-tool-for-structural-variation" class="headerlink" title="SVScore: an impact prediction tool for structural variation"></a><a href="https://academic.oup.com/bioinformatics/article/33/7/1083/2748212/SVScore-an-impact-prediction-tool-for-structural" target="_blank" rel="external">SVScore: an impact prediction tool for structural variation</a></h4><p>Bioinformatics (2017) 33 (7): 1083-1085.<br>对SV的影响进行预测。发现高影响的SV在群体中的频率更低，说明它们受到纯化选择。SVscore对预测有害突变的效果比其他软件好。研究者还发现duplication比deletion受到更强的选择。</p>
<h4 id="Fast-and-accurate-phylogeny-reconstruction-using-filtered-spaced-word-matches"><a href="#Fast-and-accurate-phylogeny-reconstruction-using-filtered-spaced-word-matches" class="headerlink" title="Fast and accurate phylogeny reconstruction using filtered spaced-word matches"></a><a href="https://academic.oup.com/bioinformatics/article/33/7/971/2883388/Fast-and-accurate-phylogeny-reconstruction-using" target="_blank" rel="external">Fast and accurate phylogeny reconstruction using filtered spaced-word matches</a></h4><p>Bioinformatics (2017) 33 (7): 971-979.<br>不依赖于比对的系统发育树构建。</p>
<h4 id="Improved-VCF-normalization-for-accurate-VCF-comparison"><a href="#Improved-VCF-normalization-for-accurate-VCF-comparison" class="headerlink" title="Improved VCF normalization for accurate VCF comparison"></a><a href="https://academic.oup.com/bioinformatics/article-abstract/33/7/964/2623048/Improved-VCF-normalization-for-accurate-VCF?redirectedFrom=fulltext" target="_blank" rel="external">Improved VCF normalization for accurate VCF comparison</a></h4><p>Bioinformatics (2017) 33 (7): 964-970.<br>该工具将VCF文件中所有的变异替换到参考序列中，生成单个样本的基因组序列。再重新call variants，生成标准的格式，便于比较。［这个比较有意思，对于indel，即使同样的变异，samtools和gatk纪录的形式不同，没法比较，通过该工具可能可以解决。］</p>
<h4 id="Biomartr-genomic-data-retrieval-with-R"><a href="#Biomartr-genomic-data-retrieval-with-R" class="headerlink" title="Biomartr: genomic data retrieval with R"></a><a href="https://academic.oup.com/bioinformatics/article/33/8/1216/2931816/Biomartr-genomic-data-retrieval-with-R" target="_blank" rel="external">Biomartr: genomic data retrieval with R</a></h4><p>Bioinformatics (2017) 33 (8): 1216-1217.<br>用来从NCBI上面下载数据（参考序列，数据库等）的R包。</p>
<h4 id="GWAlpha-genome-wide-estimation-of-additive-effects-alpha-based-on-trait-quantile-distribution-from-pool-sequencing-experiments"><a href="#GWAlpha-genome-wide-estimation-of-additive-effects-alpha-based-on-trait-quantile-distribution-from-pool-sequencing-experiments" class="headerlink" title="GWAlpha: genome-wide estimation of additive effects (alpha) based on trait quantile distribution from pool-sequencing experiments"></a><a href="https://academic.oup.com/bioinformatics/article-abstract/33/8/1246/2729762/GWAlpha-genome-wide-estimation-of-additive-effects?redirectedFrom=fulltext" target="_blank" rel="external">GWAlpha: genome-wide estimation of additive effects (alpha) based on trait quantile distribution from pool-sequencing experiments</a></h4><p>Bioinformatics (2017) 33 (8): 1246-1247.<br>通过混池测序，估计加性效应值。</p>
<h4 id="Human-Demographic-History-Impacts-Genetic-Risk-Prediction-across-Diverse-Populations30107-6"><a href="#Human-Demographic-History-Impacts-Genetic-Risk-Prediction-across-Diverse-Populations30107-6" class="headerlink" title="Human Demographic History Impacts Genetic Risk Prediction across Diverse Populations30107-6)"></a><a href="http://www.cell.com/ajhg/abstract/S0002-9297\(17\" target="_blank" rel="external">Human Demographic History Impacts Genetic Risk Prediction across Diverse Populations</a>30107-6)</h4><p>AJHG 100, 635–649, April 6, 2017<br>人类群体历史影响遗传风险预测。在一个群体中预测的疾病相关位点，也许并不适用于另一个群体。</p>
<h4 id="De-novo-assembly-of-the-Aedes-aegypti-genome-using-Hi-C-yields-chromosome-length-scaffolds"><a href="#De-novo-assembly-of-the-Aedes-aegypti-genome-using-Hi-C-yields-chromosome-length-scaffolds" class="headerlink" title="De novo assembly of the Aedes aegypti genome using Hi-C yields chromosome-length scaffolds"></a><a href="http://science.sciencemag.org/content/356/6333/92" target="_blank" rel="external">De novo assembly of the Aedes aegypti genome using Hi-C yields chromosome-length scaffolds</a></h4><p>Science  07 Apr 2017: Vol. 356, Issue 6333, pp. 92-95<br>利用Hi-C技术辅助组装，将伊蚊基因组组装到染色体水平。</p>
<h4 id="A-chromosome-conformation-capture-ordered-sequence-of-the-barley-genome"><a href="#A-chromosome-conformation-capture-ordered-sequence-of-the-barley-genome" class="headerlink" title="A chromosome conformation capture ordered sequence of the barley genome"></a><a href="http://www.nature.com/nature/journal/v544/n7651/full/nature22043.html#author-information" target="_blank" rel="external">A chromosome conformation capture ordered sequence of the barley genome</a></h4><p>Nature 544, 427–433 (27 April 2017)<br>大麦基因组发表</p>
<h4 id="SynthEx-a-synthetic-normal-based-DNA-sequencing-tool-for-copy-number-alteration-detection-and-tumor-heterogeneity-profiling"><a href="#SynthEx-a-synthetic-normal-based-DNA-sequencing-tool-for-copy-number-alteration-detection-and-tumor-heterogeneity-profiling" class="headerlink" title="SynthEx: a synthetic-normal-based DNA sequencing tool for copy number alteration detection and tumor heterogeneity profiling"></a><a href="http://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1193-3" target="_blank" rel="external">SynthEx: a synthetic-normal-based DNA sequencing tool for copy number alteration detection and tumor heterogeneity profiling</a></h4><p>Genome Biology 2017<br>基于全基因组或全外显子组测序的拷贝数变异检测工具。其能力和基于芯片的软件相当，胜过其它基于测序的软件。</p>
<h4 id="Ancient-genomic-changes-associated-with-domestication-of-the-horse"><a href="#Ancient-genomic-changes-associated-with-domestication-of-the-horse" class="headerlink" title="Ancient genomic changes associated with domestication of the horse"></a><a href="http://science.sciencemag.org/content/356/6336/442" target="_blank" rel="external">Ancient genomic changes associated with domestication of the horse</a></h4><p>Science  28 Apr 2017<br>研究人员对14匹距今2000～4000年的古马进行全基因组测序，揭示马的驯化过程。</p>
<h4 id="Genetic-signatures-of-high-altitude-adaptation-in-Tibetans"><a href="#Genetic-signatures-of-high-altitude-adaptation-in-Tibetans" class="headerlink" title="Genetic signatures of high-altitude adaptation in Tibetans"></a><a href="http://www.pnas.org/content/114/16/4189.full" target="_blank" rel="external">Genetic signatures of high-altitude adaptation in Tibetans</a></h4><p>PNAS April 18, 2017 vol. 114 no. 16 4189-4194<br>文章结合了3,008个藏族人7.3 M SNP 芯片数据以及7,287个非藏族东亚人数据，揭示了藏族人适应高原环境基因。</p>
<h4 id="Parallel-adaptive-evolution-of-geographically-distant-herring-populations-on-both-sides-of-the-North-Atlantic-Ocean"><a href="#Parallel-adaptive-evolution-of-geographically-distant-herring-populations-on-both-sides-of-the-North-Atlantic-Ocean" class="headerlink" title="Parallel adaptive evolution of geographically distant herring populations on both sides of the North Atlantic Ocean"></a><a href="http://www.pnas.org/content/114/17/E3452.full" target="_blank" rel="external">Parallel adaptive evolution of geographically distant herring populations on both sides of the North Atlantic Ocean</a></h4><p>PNAS April 25, 2017 vol. 114 no. 17 E3452-E3461<br>北大西洋鲱鱼的平行进化。</p>
<h4 id="Finding-a-Needle-in-a-Haystack-Distinguishing-Mexican-Maize-Landraces-Using-a-Small-Number-of-SNPs"><a href="#Finding-a-Needle-in-a-Haystack-Distinguishing-Mexican-Maize-Landraces-Using-a-Small-Number-of-SNPs" class="headerlink" title="Finding a Needle in a Haystack: Distinguishing Mexican Maize Landraces Using a Small Number of SNPs"></a><a href="http://journal.frontiersin.org/article/10.3389/fgene.2017.00045/full" target="_blank" rel="external">Finding a Needle in a Haystack: Distinguishing Mexican Maize Landraces Using a Small Number of SNPs</a></h4><p>Front. Genet., 18 April 2017<br>作者通过50个样本（5个不同地方种）的50k芯片数据，筛选出了用于区分不同地方种的SNPs。“we identified 20 landrace-informative SNPs and 14 altitude-informative SNPs.”</p>
<h4 id="Full-Chloroplast-Genome-Assembly-of-11-Diverse-Watermelon-Accessions"><a href="#Full-Chloroplast-Genome-Assembly-of-11-Diverse-Watermelon-Accessions" class="headerlink" title="Full Chloroplast Genome Assembly of 11 Diverse Watermelon Accessions"></a><a href="http://journal.frontiersin.org/article/10.3389/fgene.2017.00046/full" target="_blank" rel="external">Full Chloroplast Genome Assembly of 11 Diverse Watermelon Accessions</a></h4><p>Front. Genet., 18 April 2017<br>11个西瓜全叶绿体基因组序列。</p>
<h4 id="Analytical-Biases-Associated-with-GC-Content-in-Molecular-Evolution"><a href="#Analytical-Biases-Associated-with-GC-Content-in-Molecular-Evolution" class="headerlink" title="Analytical Biases Associated with GC-Content in Molecular Evolution"></a><a href="http://journal.frontiersin.org/article/10.3389/fgene.2017.00016/full" target="_blank" rel="external">Analytical Biases Associated with GC-Content in Molecular Evolution</a></h4><p>Front. Genet., 15 February 2017<br>碱基组成(GC含量)在不同位点或分类群的异质性，会使分子进化分析产生偏好性，如构建系统发育树，检测自然选择或估计密码子使用率。文章对产生偏好的原因以及避开偏好的方法进行了综述。</p>
<h4 id="A-genome-wide-association-study-identifies-six-novel-risk-loci-for-primary-biliary-cholangitis"><a href="#A-genome-wide-association-study-identifies-six-novel-risk-loci-for-primary-biliary-cholangitis" class="headerlink" title="A genome-wide association study identifies six novel risk loci for primary biliary cholangitis"></a><a href="https://www.nature.com/articles/ncomms14828" target="_blank" rel="external">A genome-wide association study identifies six novel risk loci for primary biliary cholangitis</a></h4><p>Nature Communications 8, Article number: 14828 (2017)<br>全基因组关联分析鉴定6个新的原发胆汁性胆管炎风险位点。</p>
<h4 id="Genome-assembly-with-in-vitro-proximity-ligation-data-and-whole-genome-triplication-in-lettuce"><a href="#Genome-assembly-with-in-vitro-proximity-ligation-data-and-whole-genome-triplication-in-lettuce" class="headerlink" title="Genome assembly with in vitro proximity ligation data and whole-genome triplication in lettuce"></a><a href="http://www.nature.com/articles/ncomms14953" target="_blank" rel="external">Genome assembly with in vitro proximity ligation data and whole-genome triplication in lettuce</a></h4><p>Nature Communications 8, Article number: 14953 (2017)<br>生菜基因组，2.7 G。用in vitro proximity ligation数据锚定小scaffold。</p>
<h4 id="Reconstructing-the-genome-of-the-most-recent-common-ancestor-of-flowering-plants"><a href="#Reconstructing-the-genome-of-the-most-recent-common-ancestor-of-flowering-plants" class="headerlink" title="Reconstructing the genome of the most recent common ancestor of flowering plants"></a><a href="http://www.nature.com/ng/journal/v49/n4/abs/ng.3813.html" target="_blank" rel="external">Reconstructing the genome of the most recent common ancestor of flowering plants</a></h4><p>Nature Genetics 49, 490–496 (2017)<br>开花植物最近共同祖先基因组构建。</p>
<h4 id="Asymmetric-subgenome-selection-and-cis-regulatory-divergence-during-cotton-domestication"><a href="#Asymmetric-subgenome-selection-and-cis-regulatory-divergence-during-cotton-domestication" class="headerlink" title="Asymmetric subgenome selection and cis-regulatory divergence during cotton domestication"></a><a href="http://www.nature.com/ng/journal/v49/n4/abs/ng.3807.html" target="_blank" rel="external">Asymmetric subgenome selection and cis-regulatory divergence during cotton domestication</a></h4><p>Nature Genetics 49, 579–587 (2017)<br>野生和栽培棉花揭示驯化过程中受选择基因。</p>
<h4 id="Fast-scalable-prediction-of-deleterious-noncoding-variants-from-functional-and-population-genomic-data"><a href="#Fast-scalable-prediction-of-deleterious-noncoding-variants-from-functional-and-population-genomic-data" class="headerlink" title="Fast, scalable prediction of deleterious noncoding variants from functional and population genomic data"></a><a href="http://www.nature.com/ng/journal/v49/n4/abs/ng.3810.html" target="_blank" rel="external">Fast, scalable prediction of deleterious noncoding variants from functional and population genomic data</a></h4><p>Nature Genetics 49, 618–624 (2017)<br>有害非编码突变预测。（是否适合非模式生物？）</p>
<h4 id="Single-molecule-sequencing-and-chromatin-conformation-capture-enable-de-novo-reference-assembly-of-the-domestic-goat-genome"><a href="#Single-molecule-sequencing-and-chromatin-conformation-capture-enable-de-novo-reference-assembly-of-the-domestic-goat-genome" class="headerlink" title="Single-molecule sequencing and chromatin conformation capture enable de novo reference assembly of the domestic goat genome"></a><a href="http://www.nature.com/ng/journal/v49/n4/abs/ng.3802.html" target="_blank" rel="external">Single-molecule sequencing and chromatin conformation capture enable de novo reference assembly of the domestic goat genome</a></h4><p>Nature Genetics 49, 643–650 (2017)<br>通过单分子测序和染色体构像捕获组装山羊基因组。</p>
<h4 id="Scallop-genome-provides-insights-into-evolution-of-bilaterian-karyotype-and-development"><a href="#Scallop-genome-provides-insights-into-evolution-of-bilaterian-karyotype-and-development" class="headerlink" title="Scallop genome provides insights into evolution of bilaterian karyotype and development"></a><a href="http://www.nature.com/articles/s41559-017-0120" target="_blank" rel="external">Scallop genome provides insights into evolution of bilaterian karyotype and development</a></h4><p>Nature Ecology &amp; Evolution 1, Article number: 0120 (2017)<br>扇贝基因组。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;The-Rice-Paradox-Multiple-Origins-but-Single-Domestication-in-Asian-Rice&quot;&gt;&lt;a href=&quot;#The-Rice-Paradox-Multiple-Origins-but-Single-Domestication-in-Asian-Rice&quot; class=&quot;headerlink&quot; title=&quot;The Rice Paradox: Multiple Origins but Single Domestication in Asian Rice&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://academic.oup.com/mbe/article/34/4/969/2897272/The-Rice-Paradox-Multiple-Origins-but-Single&quot;&gt;The Rice Paradox: Multiple Origins but Single Domestication in Asian Rice&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Mol Biol Evol (2017) 34 (4): 969-979.&lt;br&gt;通过对几种栽培水稻和野生祖先的基因组比较，发现不同栽培稻亚种分别来自不同的野生祖先，但是只经历了一次驯化事件。&lt;br&gt;最先被驯化的是&lt;em&gt;O. sativa&lt;/em&gt; ssp. japonica，与&lt;em&gt;O. rufipogon&lt;/em&gt;大概在∼13.1–24.1 ka前分歧。japonica与indica和aus的驯化前体存在基因流，导致后两者获得了驯化基因型。&lt;/p&gt;
&lt;h4 id=&quot;Genome-Sequencing-Reveals-the-Origin-of-the-Allotetraploid-Arabidopsis-suecica&quot;&gt;&lt;a href=&quot;#Genome-Sequencing-Reveals-the-Origin-of-the-Allotetraploid-Arabidopsis-suecica&quot; class=&quot;headerlink&quot; title=&quot;Genome Sequencing Reveals the Origin of the Allotetraploid Arabidopsis suecica&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://academic.oup.com/mbe/article/34/4/957/2838775/Genome-Sequencing-Reveals-the-Origin-of-the&quot;&gt;Genome Sequencing Reveals the Origin of the Allotetraploid Arabidopsis suecica&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Mol Biol Evol (2017) 34 (4): 957-968.&lt;br&gt;对15个异源四倍体拟南芥&lt;em&gt;Arabidopsis suecica&lt;/em&gt;进行了重测序。发现其与多个祖先物种共享多态性，排除了单一起源。该物种大概在末次盛冰期(LGM)的东欧或欧亚大陆中部出现。还发现两个自交不亲和基因都没有功能。&lt;/p&gt;
    
    </summary>
    
      <category term="paper_express" scheme="http://www.colyfu.com/categories/paper-express/"/>
    
    
      <category term="文献导读" scheme="http://www.colyfu.com/tags/%E6%96%87%E7%8C%AE%E5%AF%BC%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>判断fastq文件质量编码格式及Phred64转Phred33方法</title>
    <link href="http://www.colyfu.com/QC/fastq-phred-trans.html"/>
    <id>http://www.colyfu.com/QC/fastq-phred-trans.html</id>
    <published>2017-04-25T13:37:56.000Z</published>
    <updated>2017-04-26T09:11:07.000Z</updated>
    
    <content type="html"><![CDATA[<p>前几天有朋友从网上下载了一批fastq文件，为Phred64格式，分析之前没发现，比对的时候BWA报错了。很多人可能没有接触过老Illumina数据，不知道怎么判断编码格式，也不知道怎么转为Phred33格式，所以简单说明一下怎么判断fastq文件的质量编码方式以及怎么将Phred64编码格式转为Phred33编码格式。</p>
<a id="more"></a>
<ul>
<li><h3 id="Phred64-33质量编码格式区别"><a href="#Phred64-33质量编码格式区别" class="headerlink" title="Phred64/33质量编码格式区别"></a>Phred64/33质量编码格式区别</h3><p>fastq文件中，碱基质量是用ASCII字符表示。Phred64编码格式，碱基质量值为字符的十进制ASCII码减去64。同理，Phred33编码格式，碱基质量值为字符的十进制ASCII码减去33。一般碱基的质量值范围为[0, 41]，X ten之后，质量值只有(2,7,11,22,27,32,37,42)几个梯度。因此，GATK的BQSR过程对于X ten的数据可能更加重要。<br>Phred质量值Q和出错的概率P的关系为Q = -10*lg(P)，如碱基质量值为30，表示出错的概率为0.001，碱基质量值为20，表示出错的概率为0.01。<br>目前主流软件如BWA, GATK等都识别的是Phred33质量编码格式，如果为Phred64格式，则可能会报错，即使不报错，后续的分析也会有问题。因此，下载的数据如果不清楚编码格式，需要先判断，如果为Phred64，则需要转为Phred33格式。</p>
</li>
<li><h3 id="判断fastq文件质量值编码格式"><a href="#判断fastq文件质量值编码格式" class="headerlink" title="判断fastq文件质量值编码格式"></a>判断fastq文件质量值编码格式</h3><p>格式判断既可以通过肉眼快速判断，也可以使用<a href="http://onzjn6hm6.bkt.clouddn.com/CheckFqQualityCode.pl" target="_blank" rel="external">下面的脚本</a>进行判断。如果文件少，没有编程基础，可以用快速判断的方法。利用程序判断更加准确、快速、可批量处理，因此有编程基础的人，应该尽量使用程序判断。</p>
</li>
</ul>
<blockquote>
<p><strong>肉眼快速判断</strong>：质量字符有数字<code>[0~9]</code>的为Phred33，有小写字母<code>[a~z]</code>的为Phred64。<br><strong>通过程序</strong>：基本思路为将一定数量的reads质量值字符转为ASCII码，然后判断质量值的范围。<br><a href="http://onzjn6hm6.bkt.clouddn.com/CheckFqQualityCode.pl" target="_blank" rel="external">脚本</a>的使用方法如下，第一个参数为fastq文件，自动判断是否为压缩文件，第二个参数为用于判断的reads数，默认为1000。<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl CheckFqQualityCode.pl prefix.fq[.gz] [1000]</div></pre></td></tr></table></figure></p>
</blockquote>
<ul>
<li><h3 id="Phred64格式转Phred33格式"><a href="#Phred64格式转Phred33格式" class="headerlink" title="Phred64格式转Phred33格式"></a>Phred64格式转Phred33格式</h3>Phred64格式转Phred33格式的原理很简单，只需在原有ASCII码的基础上减去64再加上33既可。大家可以自己写，也可以使用lh写的<a href="https://github.com/lh3/seqtk" target="_blank" rel="external">seqtk</a>工具，使用命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">seqtk seq -VQ64 prefix.phred64.fq.gz | gzip &gt; prefix.phred33.fq.gz</div></pre></td></tr></table></figure></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;前几天有朋友从网上下载了一批fastq文件，为Phred64格式，分析之前没发现，比对的时候BWA报错了。很多人可能没有接触过老Illumina数据，不知道怎么判断编码格式，也不知道怎么转为Phred33格式，所以简单说明一下怎么判断fastq文件的质量编码方式以及怎么将Phred64编码格式转为Phred33编码格式。&lt;/p&gt;
    
    </summary>
    
      <category term="QC" scheme="http://www.colyfu.com/categories/QC/"/>
    
    
      <category term="fastq" scheme="http://www.colyfu.com/tags/fastq/"/>
    
      <category term="phred33" scheme="http://www.colyfu.com/tags/phred33/"/>
    
      <category term="phred64" scheme="http://www.colyfu.com/tags/phred64/"/>
    
      <category term="格式" scheme="http://www.colyfu.com/tags/%E6%A0%BC%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>GWAS如何确定候选区间和causal gene</title>
    <link href="http://www.colyfu.com/GWAS/GWAS-candidate.html"/>
    <id>http://www.colyfu.com/GWAS/GWAS-candidate.html</id>
    <published>2017-04-09T12:33:37.000Z</published>
    <updated>2017-05-27T12:17:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>随着高通量测序成本的急剧下降，越来越多的GWAS研究通过全基因组重测序获得标记。全基因组重测序的高密度标记，使得通过GWAS研究快速找到causal gene甚至causal mutation成为可能。但是通过GWAS得到一个信号后，怎么确定与这个信号关联的基因呢？  </p>
<a id="more"></a>
<p>基本的思路就是找与这个信号强连锁的区域，一般来说r<sup>2</sup>大于0.6的区域视为强连锁的区域。简单粗糙的做法：我们可以通过群体的全基因组LD-decay分析，找到LD decay到r<sup>2</sup>等于0.6时所对应的距离，将GWAS超过阈值的信号前后各延伸这个距离作为候选区间。<br>但是基因组不同区域的连锁程度差异很大，上面一刀切的做法可能使我们漏掉一些基因，或者多调查许多关联性并不强的基因。而且很多作物的连锁性很强，导致候选基因很多，这样就大大增加了工作难度。下面介绍一个非常简单高效的方法（<a href="http://www.nature.com/ng/journal/v48/n8/abs/ng.3596.html" target="_blank" rel="external">参考文献</a>）。  </p>
<p align="center"><br>  <img src="http://onzjn6hm6.bkt.clouddn.com/20170409_heatmap.png" width="300"><br></p>

<ol>
<li><p>找到信号后，向前后延伸一段距离（可以根据全基因组的LD-decay水平大概估计），计算这段区域内所有标记pairwise r<sup>2</sup>，将r<sup>2</sup>大于0.6的block作为候选区间。pairwise r<sup>2</sup>可以用<a href="http://zzz.bwh.harvard.edu/plink/" target="_blank" rel="external">PLINK</a>计算：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plink --noweb --bfile &lt;bfile_prefix&gt; \</div><div class="line">      --chr 5 --from-bp 13641890 --to-bp 17641890 \</div><div class="line">      --matrix --r2 --out &lt;out_prefix&gt;</div></pre></td></tr></table></figure>
<p>画图用R,输入文件为plink计算的到的r<sup>2</sup>矩阵，以及标记的位置:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env Rscript</span></div><div class="line"><span class="keyword">library</span>(LDheatmap)</div><div class="line">argv &lt;- commandArgs(<span class="literal">TRUE</span>)</div><div class="line">ldmatrix &lt;- as.matrix(read.table(argv[<span class="number">1</span>],sep=<span class="string">' '</span>))</div><div class="line">pos &lt;- as.numeric(unlist(read.table(argv[<span class="number">2</span>], head=<span class="literal">FALSE</span>)))</div><div class="line">pdf(argv[<span class="number">3</span>])</div><div class="line">rgb.palette &lt;- colorRampPalette(rev(c(<span class="string">"yellow"</span>, <span class="string">"orange"</span>, <span class="string">"red"</span>)), space = <span class="string">"rgb"</span>)</div><div class="line">LDheatmap(ldmatrix, genetic.distances=pos, color=rgb.palette(<span class="number">100</span>), flip=<span class="literal">TRUE</span>)</div><div class="line">dev.off()</div></pre></td></tr></table></figure>
</li>
<li><p>将这个区域内的标记按照其对基因功能的影响程度分为5类：  </p>
<blockquote>
<p>1） 标记与性状显著关联（-log<sub>10</sub>P大于阈值），且该标记影响氨基酸编码，或者位于剪接位点；<br>2） 标记与性状显著关联，且位于基因起始密码子上游2 kb内；<br>3） 标记与性状显著关联，且位于基因内，除开1）和2）之外的标记<br>4） 标记与性状显著关联，位于基因间区<br>5） 标记与性状不显著关联  </p>
</blockquote>
</li>
</ol>
<p>然后，按照这5类的顺序，依次调查，一般来说，属于1）类的可能性很大，而且基因一般就几个，这样就大大减少了工作难度。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;随着高通量测序成本的急剧下降，越来越多的GWAS研究通过全基因组重测序获得标记。全基因组重测序的高密度标记，使得通过GWAS研究快速找到causal gene甚至causal mutation成为可能。但是通过GWAS得到一个信号后，怎么确定与这个信号关联的基因呢？  &lt;/p&gt;
    
    </summary>
    
      <category term="GWAS" scheme="http://www.colyfu.com/categories/GWAS/"/>
    
    
      <category term="GWAS" scheme="http://www.colyfu.com/tags/GWAS/"/>
    
      <category term="causal gene" scheme="http://www.colyfu.com/tags/causal-gene/"/>
    
      <category term="LD" scheme="http://www.colyfu.com/tags/LD/"/>
    
      <category term="heat map" scheme="http://www.colyfu.com/tags/heat-map/"/>
    
  </entry>
  
</feed>
